/*! JsViews v1.0.0-alpha: http://github.com/BorisMoore/jsviews and http://jsviews.com/jsviews
informal pre V1.0 commit counter: 57 (Beta Candidate) */
(function(n,t,i){"use strict";function d(n,r,u){var b,tt,a,o,k,v,s,d,c,y,it,g,nt,e,l,p,w=n.target,rt=w._jsvBnd,ut=/&(\d+)\+?/g;if(rt)while(y=ut.exec(rt))if((y=h[y[1]])&&(l=y.to)){if(o=y.linkCtx,c=o.view,e=o.tag,d=t(w),g=c.hlp(ni),nt=c.hlp(ti),a=lt(w),b=ui[a],u===i&&(u=et(a)?a(w):b?d[b]():d.attr(a)),v=l[1],l=l[0],v&&(k=et(v)?v:c.getRsc("converters",v)),k&&(u=k.call(e,u)),it=c.linkCtx,c.linkCtx=o,p={change:"change",oldValue:o._val,value:u},(!g||!(tt=g.call(o,n,p)===!1))&&(!e||!e.onBeforeChange||!(tt=e.onBeforeChange(n,p)===!1))&&u!==i&&(s=l[0],u!==i&&s)){if(s=s._jsvOb?s._ob:s,e&&(e._.chging=!0),f(s).setProperty(l[2]||l[1],u),nt&&nt.call(o,n,p),e){if(e.onAfterChange)e.onAfterChange(n,p);delete e._.chging}o._val=u}c.linkCtx=it}}function vu(n,t,u){var h,f,e,p,o=this,y=o.data,a=o.elem,c=o.convert,b=a.parentNode,s=o.view,w=s.linkCtx,v=s.hlp(ni);if(s.linkCtx=o,b&&(!v||!(t&&v.call(o,n,t)===!1))&&!(t&&n.data.prop!=="*"&&n.data.prop!==t.path)){if(t&&(o.eventArgs=t),t||o._initVal){if(delete o._initVal,f=u.call(s.tmpl,y,s,r),h=yu(f,o,e=o.tag,o.attr||lt(a,!0,c!==i)),f&&f.error!==i)f=f.error;else if(e){if(f=f[0]?f:[f],p=t&&e.onUpdate&&e.onUpdate(n,t,f)===!1,wr(e,f),p||h===ht){h===l&&e.onBeforeLink&&e.onBeforeLink();pt(e,e.tagCtx);li(o,y,a);s.linkCtx=w;return}if(e._.chging)return;f=e.tagName===":"?r._cnvt(e.cvt,s,f[0]):r._tag(e,s,s.tmpl,f,!0)}else u._tag&&(c=c===""?ct:c,f=c?r._cnvt(c,s,f):r._tag(u._tag,s,s.tmpl,f,!0),e=o.tag,h=o.attr||h);sr(f,o,h,e)&&t&&(v=s.hlp(ti))&&v.call(o,n,t);e&&pt(e,e.tagCtx)}li(o,y,a);s.linkCtx=w}}function yu(n,r,u,f){var e,h,c,o,s=u&&u.parentElem||r.elem;if(n!==i){if(o=t(s),f=u&&u.attr||f,et(n)&&tt(r.expr+": missing parens"),f==="visible"&&(f="css-display"),c=/^css-/.test(f)&&f.slice(4))e=t.style(s,c),+n===n&&(e=parseInt(e));else if(f!=="link"){if(f==="value")s.type===ii&&(e=o.prop(f=k));else if(f===st)if(s.value===""+n)e=o.prop(k);else return f;e===i&&(h=ui[f],e=h?o[h]():o.attr(f))}r._val=e}return f}function sr(r,u,f,o){var et,h,c,nt,ot,d,v,g,y,w,b,tt,it,rt=r!==i,ct=u.data,s=o&&o.parentElem||u.elem,ut=t(s),p=u.view,ft=u._val,lt=p.linkCtx,a=o||f===l;if(o&&(o.parentElem=o.parentElem||u.expr||o._elCnt?s:s.parentNode,h=o._prv,c=o._nxt),!rt){f===l&&o&&o.onBeforeLink&&o.onBeforeLink();return}if(/^css-/.test(f))u.attr==="visible"&&(it=(s.currentStyle||or.call(n,s,"")).display,r?(r=s._jsvd||it,r!==ht||(r=ur[tt=s.nodeName])||(b=e.createElement(tt),e.body.appendChild(b),r=ur[tt]=(b.currentStyle||or.call(n,b,"")).display,e.body.removeChild(b))):(s._jsvd=it,r=ht)),(a=a||ft!==r)&&t.style(s,f.slice(4),r);else if(f!=="link"){if(f===k)d=!0,r=r&&r!=="false";else if(f===st)if(s.value===""+r)r=d=!0,f=k;else{li(u,ct,s);return}else(f==="selected"||f==="disabled"||f==="multiple"||f==="readonly")&&(r=r&&r!=="false"?f:null);(et=ui[f])?f===l?(p.linkCtx=u,o&&o._.inline?(ot=o.nodes(!0),o._elCnt&&(h&&h!==c?wi(h,c,s,o._tgId,"^",!0):(v=s._dfr)&&(g=o._tgId+"^",y=v.indexOf("#"+g)+1,w=v.indexOf("/"+g),y&&w>0&&(y+=g.length,w>y&&(s._dfr=v.slice(0,y)+v.slice(w),kr(v.slice(y,w))))),h=h?h.previousSibling:c?c.previousSibling:s.lastChild),t(ot).remove(),o&&o.onBeforeLink&&o.onBeforeLink(),nt=p.link(p.data,s,h,c,r,o&&{tag:o._tgId,lazyLink:o.tagCtx.props.lazyLink})):(rt&&ut.empty(),o&&o.onBeforeLink&&o.onBeforeLink(),rt&&(nt=p.link(ct,s,h,c,r,o&&{tag:o._tgId}))),p.linkCtx=lt):(a=a||ft!==r)&&(f==="text"&&s.children&&!s.children[0]?s.textContent!==i?s.textContent=r:s.innerText=r===null?"":r:ut[et](r)):(a=a||ft!==r)&&ut[d?"prop":"attr"](f,r===i&&!d?null:r);u._val=r}return nt||a}function hr(n,t){var i=this,r=i.hlp(ni),u=i.hlp(ti);if(!r||r.call(this,n,t)!==!1){if(t){var o=t.change,f=t.index,e=t.items;switch(o){case"insert":i.addViews(f,e);break;case"remove":i.removeViews(f,e.length);break;case"move":i.refresh();break;case"refresh":i.refresh()}}u&&u.call(this,n,t)}}function ci(n){var u,f,o=n.type,e=n.data,r=n._.bnd;if(!n._.useKey&&r)if((f=n._.bndArr)&&(t([f[1]]).off(gt,f[0]),n._.bndArr=i),r!==!!r&&r._.inline)o?r._.arrVws[n._.id]=n:delete r._.arrVws[n._.id];else if(o&&e){u=function(t){t.data&&t.data.off||hr.apply(n,arguments)};t([e]).on(gt,u);n._.bndArr=[u,e]}}function lt(n,t,i){var u=n.nodeName.toLowerCase(),r=c.merge[u]||n.contentEditable===ct&&{to:l,from:l};return r?t?u==="input"&&n.type===st?st:r.to:r.from:t?i?"text":l:""}function cr(n,r,u,f,e,o,s){var p,c,v,w,b,l=n.parentElem,h=n._prv,a=n._nxt,y=n._elCnt;if(h&&h.parentNode!==l&&tt("Missing parentNode"),s){w=n.nodes();y&&h&&h!==a&&wi(h,a,l,n._.id,"_",!0);n.removeViews(i,i,!0);c=a;y&&(h=h?h.previousSibling:a?a.previousSibling:l.lastChild);t(w).remove();for(b in n._.bnds)bt(b)}else{if(r){if(v=f[r-1],!v)return!1;h=v._nxt}y?(c=h,h=c?c.previousSibling:l.lastChild):c=h.nextSibling}p=u.render(e,o,n._.useKey&&s,n,s||r,!0);n.link(e,l,h,c,p,v)}function at(n,t,r){var u,f,e;return r?(e="^`",f=t._.tag||{_:{inline:!0,bnd:r},tagCtx:{view:t},flow:!0},u=f._tgId,u||(h[u=fr++]=f,f._tgId=""+u)):(e="_`",p[u=t._.id]=t),"#"+u+e+(n!=i?n:"")+"/"+u+e}function li(n,t,r){var o,a,e,u=n.tag,v=n.convertBack,c=[],l=n._bndId||""+fr++,y=n._hdlr;if(delete n._bndId,u&&(c=u.depends||c,c=et(c)?u.depends(u):c,e=u.linkedElem),(!n._depends||""+n._depends!=""+c)&&(n._depends&&f._apply(!1,[t],n._depends,y,!0),o=f._apply(!1,[t],n.fn.deps,c,y,n._ctxCb),o.elem=r,o.linkCtx=n,o._tgId=l,r._jsvBnd=r._jsvBnd||"",r._jsvBnd+="&"+l,n._depends=c,n.view._.bnds[l]=l,h[l]=o,e&&(o.to=[[],v]),(e||v!==i)&&pr(o,u&&u.convertBack||v),u)){if(u.onAfterBind)u.onAfterBind(o);u.flow||u._.inline||(r.setAttribute(s,(r.getAttribute(s)||"")+"#"+l+"^/"+l+"^"),u._tgId=""+l)}if(e&&e[0])for(u._.radio&&(e=e.children("input[type=radio]")),a=e.length;a--;)e[a]._jsvBnd=e[a]._jsvBnd||r._jsvBnd+"+",e[a]._jsvLkEl=u}function lr(n,t,i,r,u,f,e){return ai(this,n,t,i,r,u,f,e)}function ai(n,r,u,f,o,s,h,c){if(n&&r){if(r=r.jquery?r:t(r),!g){g=e.body;t(g).on(gi,d).on("blur","[contenteditable]",d)}for(var y,k,tt,b,v,w,l,it,rt=at,ft=f&&f.target==="replace",ut=r.length;ut--;)if(l=r[ut],""+n===n)vt(n,l,nt(l),i,!0,u,f);else{if(s=s||nt(l),n.markup!==i)s.link===!1&&(f=f||{},f.link=rt=!1),ft&&(w=l.parentNode),tt=n.render(u,f,o,s,i,rt),w?(h=l.previousSibling,c=l.nextSibling,t.cleanData([l],!0),w.removeChild(l),l=w):(h=c=i,t(l).empty());else if(n)it={lnk:1};else break;if(l._dfr&&!c){for(b=a(l._dfr,!0,er),y=0,k=b.length;y<k;y++)v=b[y],(v=p[v.id])&&v.data!==i&&v.parent.removeViews(v._.key,i,!0);l._dfr=""}s.link(u,l,h,c,tt,it,f)}}return r}function pu(n,r,u,f,l,y,w,b){function ou(n,t,r,u,f,e,o,h,c,a,v,y,p){var w,b="";return p?(ri=0,n):(k=h||c||"",u=u||a,r=r||y,li&&!r&&(u||k||e)&&(li=i,it=dt.shift()),u=u||r,u&&(ri=0,li=i,ar&&(r||y?hi[it]||/;svg;|;math;/.test(";"+dt.join(";")+";")||(w="'<"+it+".../"):hi[u]?w="'<\/"+u:dt.length&&u===it||(w="Mismatch: '<\/"+u),w&&ei(w+">' in:\n"+l)),ir=rt,it=dt.shift(),rt=si[it],a=a?"<\/"+a+">":"",ir&&(st+=lt,lt="",rt?st+="-":(b=a+tr+"@"+st+nr+(v||""),st=ru.shift()))),rt?(e?lt+=e:t=a||y||"",k&&(t+=k,lt&&(t+=" "+s+'="'+lt+'"',lt=""))):t=e?t+b+f+tr+e+nr+o+k:b||n,ri&&e&&ei(" No {^{ tags within elem markup ("+ri+' ). Use data-link="..."'),k&&(ri=k,dt.unshift(it),it=k.slice(1),dt[0]&&dt[0]===eu[it]&&tt("Parent of <tr> must be <tbody>"),li=hi[it],(rt=si[it])&&!ir&&(ru.unshift(st),st=""),ir=rt,st&&rt&&(st+="+")),t)}function yi(n,t){var o,l,u,e,f,a,s,c=[];if(n){for(n._tkns.charAt(0)==="@"&&(t=d.previousSibling,d.parentNode.removeChild(d),d=i),bt=n.length;bt--;){if(et=n[bt],u=et.ch,o=et.path)for(ut=o.length-1;l=o.charAt(ut--);)l==="+"?o.charAt(ut)==="-"?(ut--,t=t.previousSibling):t=t.parentNode:t=t.lastChild;u==="^"?(k=h[f=et.id])&&(s=t&&(!d||d.parentNode!==t),(!d||s)&&(k.parentElem=t),et.elCnt&&s&&(t._dfr=(et.open?"#":"/")+f+u+(t._dfr||"")),c.push([s?null:d,et])):(g=p[f=et.id])&&(g.parentElem||(g.parentElem=t||d&&d.parentNode||r,g._.onRender=at,g._.onArrayChange=hr,ci(g)),e=g.parentElem,et.open?(g._elCnt=et.elCnt,t&&!d?t._dfr="#"+f+u+(t._dfr||""):(g._prv||(e._dfr=yt(e._dfr,"#"+f+u)),g._prv=d)):(t&&(!d||d.parentNode!==t)?(t._dfr="/"+f+u+(t._dfr||""),g._nxt=i):d&&(g._nxt||(e._dfr=yt(e._dfr,"/"+f+u)),g._nxt=d),ui=g.linkCtx,(a=g.ctx&&g.ctx.onAfterCreate||cu)&&a.call(ui,g)))}for(bt=c.length;bt--;)vi.push(c[bt])}return!n||n.elCnt}function hu(n){var t,i;if(n)for(bt=n.length,ut=0;ut<bt;ut++)if(et=n[ut],ht.id)ht.id=ht.id!==et.id&&ht.id;else if(i=k=h[et.id].linkCtx.tag,!k.flow){if(!sr){for(t=1;i=i.parent;)t++;di=di||t}(sr||t===di)&&(!cr||k.tagName===cr)&&or.push(k)}}function br(){for(fr=oi?r.querySelectorAll(ft):t(ft,r).get(),ni=fr.length,u&&u.innerHTML&&(pi=oi?u.querySelectorAll(ft):t(ft,u).get(),u=pi.length?pi[pi.length-1]:u),di=0,wt=0;wt<ni;wt++)if(d=fr[wt],u&&!gr)gr=d===u;else if(f&&d===f)break;else d.parentNode&&fu(a(d,i,or&&lu))&&!ht&&d.getAttribute(v)&&vi.push([d]);if(l===i&&r.getAttribute(v)&&vi.push([r]),vr(u,rt),vr(f,rt),ht){kt&&kt.resolve();return}for(rt&&st+lt&&(d=f,st&&(f?yi(a(st+"+",!0),f):yi(a(st,!0),r)),yi(a(lt,!0),r),f&&(ot=f.getAttribute(s),(ni=ot.indexOf(ur)+1)&&(ot=ot.slice(ni+ur.length-1)),f.setAttribute(s,lt+ot))),ni=vi.length,wt=0;wt<ni;wt++)d=vi[wt],gt=d[1],d=d[0],gt?(k=h[gt.id])&&((ui=k.linkCtx)&&(k=ui.tag,k.linkCtx=ui),gt.open?(d&&(k.parentElem=d.parentNode,k._prv=d),k._elCnt=gt.elCnt,!k||k.onBeforeLink&&k.onBeforeLink()===!1||k._.bound||(k._.bound=!0,g=k.tagCtx.view,vt(i,k._prv,g,gt.id)),k._.linking=!0):(k._nxt=d,k._.linking&&(lr=k.tagCtx,g=lr.view,delete k._.linking,k._.bound||(k._.bound=!0,vt(i,k._prv,g,gt.id)),pt(k,lr)))):(g=nt(d),vt(d.getAttribute(v),d,g,i,nu,n,w));kt&&kt.resolve()}var ri,ui,k,wt,ni,ut,bt,fr,d,g,et,gt,pi,wi,er,bi,ti,or,sr,cr,lr,ar,di,ht,kr,pr,dr,fi,it,li,ai,gi,ot,rt,ir,ii,lt,ur,gr,kt,nu,wr=this,iu=wr._.id+"_",st="",vi=[],dt=[],ru=[],cu=wr.hlp(tu),fu=yi;if(y&&(kt=y.lazyLink&&t.Deferred(),y.tmpl?er="/"+y._.id+"_":(nu=y.lnk,ht=y.get,y.tag&&(iu=y.tag+"^",y=!0)),y=y===!0),ht&&(fu=hu,or=ht.tags,sr=ht.deep,cr=ht.name),r=r?""+r===r?t(r)[0]:r.jquery?r[0]:r:wr.parentElem||e.body,ar=!c.noValidate&&r.contentEditable!==ct,it=r.tagName.toLowerCase(),rt=!!si[it],u=u&&yr(u,rt),f=f&&yr(f,rt)||null,l!=i){if(gi=e.createElement("div"),ai=gi,ur=lt="",ii=r.namespaceURI==="http://www.w3.org/2000/svg"?"svg_ns":(fi=uu.exec(l))&&fi[1]||"",ki&&fi&&fi[2]&&tt("Unsupported: "+fi[2]),rt){for(ti=f;ti&&!(bi=a(ti));)ti=ti.nextSibling;(ot=bi?bi._tkns:r._dfr)&&(wi=er||"",(y||!er)&&(wi+="#"+iu),ut=ot.indexOf(wi),ut+1&&(ut+=wi.length,ur=lt=ot.slice(0,ut),ot=ot.slice(ut),bi?ti.setAttribute(s,ot):r._dfr=ot))}if(li=i,l=(""+l).replace(su,ou),ar&&dt.length&&ei("Mismatched '<"+it+"...>' in:\n"+l),b)return;for(rr.appendChild(gi),ii=o[ii]||o.div,kr=ii[0],ai.innerHTML=ii[1]+l+ii[2];kr--;)ai=ai.lastChild;for(rr.removeChild(gi),pr=e.createDocumentFragment();dr=ai.firstChild;)pr.appendChild(dr);r.insertBefore(pr,f)}return kt?setTimeout(br,0):br(),kt&&kt.promise()}function vt(n,t,r,f,e,o,s){var k,y,w,c,d,g,p,b,v,a,nt;if(f)a=h[f],a=a.linkCtx?a.linkCtx.tag:a,v=a.linkCtx||{data:r.data,elem:a._elCnt?a.parentElem:t,view:r,ctx:r.ctx,attr:l,fn:a._.bnd,tag:a,_bndId:f},ar(v,v.fn);else if(n&&t)for(o=e?o:r.data,k=r.tmpl,n=wu(n,lt(t)),it.lastIndex=0;y=it.exec(n);)nt=it.lastIndex,w=y[1],p=y[3],d=y[10],c=i,v={data:o,elem:t,view:r,ctx:s,attr:w,isLk:e,_initVal:!y[2]},y[6]&&(!w&&(c=/:([\w$]*)$/.exec(d))&&(c=c[1],c!==i&&(g=-c.length-1,p=p.slice(0,g-1)+rt)),c===null&&(c=i),v.convert=y[5]||""),v.expr=w+p,b=k.links[p],b||(k.links[p]=b=u.tmplFn(p,k,!0,c)),v.fn=b,w||c===i||(v.convertBack=c),ar(v,b),it.lastIndex=nt}function ar(n,t){function r(i,r){vu.call(n,i,r,t)}r.noArray=!0;n.isLk&&(n.view=new u.View(n.ctx,"link",y,n.data,y.tmpl,i,i,at));n._ctxCb=ku(n.view);n._hdlr=r;r(!0)}function yt(n,t){var i;return n?(i=n.indexOf(t),i+1?n.slice(0,i)+n.slice(i+t.length):n):""}function vi(n){return n&&(""+n===n?n:n.tagName==="SCRIPT"?n.type.slice(3):n.nodeType===1&&n.getAttribute(s)||"")}function a(n,t,i){function e(n,t,i,r,e,o){u.push({elCnt:f,id:r,ch:e,open:t,close:i,path:o,token:n})}var f,r,u=[];if(r=t?n:vi(n))return u.elCnt=!n.type,f=r.charAt(0)==="@"||!n.type,u._tkns=r,r.replace(i||au,e),u}function vr(n,t){n&&(n.type==="jsv"?n.parentNode.removeChild(n):t&&n.getAttribute(v)===""&&n.removeAttribute(v))}function yr(n,t){for(var i=n;t&&i&&i.nodeType!==1;)i=i.previousSibling;return i&&(i.nodeType!==1?(i=e.createElement("SCRIPT"),i.type="jsv",n.parentNode.insertBefore(i,n)):vi(i)||i.getAttribute(v)||i.setAttribute(v,"")),i}function wu(n,i){return n=t.trim(n).replace(fu,"\\$&"),n.slice(-1)!==rt?n=dt+":"+n+(i?":":"")+rt:n}function pt(n,r){var e,f,l,o,s,y,p,a,w,v,b=r.view,c=n.linkCtx=n.linkCtx||{tag:n,data:b.data,view:b,ctx:b.ctx};if(n.onAfterLink)n.onAfterLink(r,c);if(e=n.targetTag?n.targetTag.linkedElem:n.linkedElem,(f=e&&e[0])&&((l=n._.radio)&&(e=e.children("input[type=radio]")),l||!n._.chging)){if(o=u.cvt(n,n.convert)[0],l||f!==c.elem){for(p=e.length;p--;){if(f=e[p],a=f._jsvLkEl,n._.inline&&(!a||a!==n&&a.targetTag!==n))for(f._jsvLkEl=n,s=c.elem?c.elem._jsvBnd:n._prv._jsvBnd,f._jsvBnd=s+"+",s=s.slice(1).split("&"),y=s.length;y--;)pr(h[s[y]],n.convertBack);l&&(f[k]=o===f.value)}c._val=o}o!==i&&(l||f.value===i?f.contentEditable===ct&&(f.innerHTML=o):f.type===ii?f[k]=o&&o!=="false":e.val(o))}(f=f||n.tagName===":"&&c.elem)&&(w=f._jsvTr,v=r.props.trigger,w!==v&&(f._jsvTr=v,e=e||t(f),yi(e,w,"off"),yi(e,v,"on")))}function bu(n){setTimeout(function(){d(n)},0)}function yi(n,t,i){t&&n[i](t===!0?"keydown":t,t===!0?bu:d)}function pr(n,t){var o,f,s,r,e,u=n.linkCtx,h=u.data,i=u.fn.paths;if(n&&i){for(i=(o=i._jsvto)||i[0],f=i&&i.length;f&&""+(r=i[--f])!==r;);r&&(!u.tag||u.tag.tagCtx.args.length)?(r=r.split("^").join("."),n.to=r.charAt(0)==="."?[[e=i[f-1],r.slice(1)],t]:[u._ctxCb(s=f?i[0].split("^").join("."):r)||[h,s],t],o&&e&&(n.to[0][0]=u._ctxCb(e,h))):n.to=[[],t]}}function wr(n,t){var i,u,e=n.tagCtx.view,o=n.tagCtxs||[n.tagCtx],s=o.length,h=!t;for(t=t||n._.bnd.call(e.tmpl,(n.linkCtx||e).data,e,r);s--;)i=o[s],u=t[s],f(i.props).setProperty(u.props),w(i.ctx,u.ctx),i.args=u.args,h&&(i.tmpl=u.tmpl);return o}function wt(n){for(var u,t,i,f=[],e=n.length,r=e;r--;)f.push(n[r]);for(r=e;r--;)if(t=f[r],t.parentNode){if(i=t._jsvBnd)for(i=i.slice(1).split("&"),t._jsvBnd="",u=i.length;u--;)bt(i[u],t._jsvLkEl,t);kr(vi(t)+(t._dfr||""))}}function bt(n,r,f){var y,c,e,l,a,p,w,b,v,s,k,o=h[n];if(r)f===r.linkedElem[0]&&(delete f._jsvLkEl,delete r.linkedElem);else if(o){delete h[n];for(y in o.bnd)l=o.bnd[y],a=".obs"+o.cbId,t.isArray(l)?t([l]).off(gt+a).off(di+a):t(l).off(di+a),delete o.bnd[y];if(c=o.linkCtx){if(e=c.tag){if(p=e.tagCtxs)for(w=p.length;w--;)(b=p[w].map)&&b.unmap();v=e.linkedElem;s=v&&v[0]||c.elem;(k=s&&s._jsvTr)&&(yi(v||t(s),k,"off"),s._jsvTr=i);e.onDispose&&e.onDispose();e._elCnt||(e._prv&&e._prv.parentNode.removeChild(e._prv),e._nxt&&e._nxt.parentNode.removeChild(e._nxt))}delete c.view._.bnds[n]}delete u._cbBnds[o.cbId]}}function pi(n,r){return n===i?(g&&(t(g).off(gi,d).off("blur","[contenteditable]",d),g=i),n=!0,y.removeViews(),wt(e.body.getElementsByTagName("*"))):r&&n===!0&&(r=r.jquery?r:t(r),r.each(function(){for(var n;(n=nt(this,!0))&&n.parent;)n.parent.removeViews(n._.key,i,!0);wt(this.getElementsByTagName("*"));wt([this])})),r}function br(n,t){return pi(this,n,t)}function ku(n){return function(t,i){var f,u,e=[i];if(n&&t){if(t._jsvOb)return t._jsvOb.call(n.tmpl,i,n,r);if(t.charAt(0)==="~")return t.slice(0,4)==="~tag"&&(u=n.ctx,t.charAt(4)==="."&&(f=t.slice(5).split("."),u=u.tag),f)?u?[u,f.join("."),i]:[]:(t=t.slice(1).split("."),(i=n.hlp(t.shift()))&&(t.length&&e.unshift(t.join(".")),e.unshift(i)),i?e:[]);if(t.charAt(0)==="#")return t==="#data"?[]:[n,t.replace(ou,""),i]}}}function du(n){return n.type===ii?n[k]:n.value}function wi(n,t,i,r,u,f){var v,c,y,o,b,l,e,w=0,k=n===t;if(n){for(y=a(n)||[],v=0,c=y.length;v<c;v++){if(o=y[v],l=o.id,l===r&&o.ch===u)if(f)c=0;else break;k||(b=o.ch==="_"?p[l]:h[l].linkCtx.tag,o.open?b._prv=t:o.close&&(b._nxt=t));w+=l.length+2}w&&n.setAttribute(s,n.getAttribute(s).slice(w));e=t?t.getAttribute(s):i._dfr;(c=e.indexOf("/"+r+u)+1)&&(e=y._tkns.slice(0,w)+e.slice(c+(f?-1:r.length+1)));e&&(t?t.setAttribute(s,e):i._dfr=e)}else i._dfr=yt(i._dfr,"#"+r+u),f||t||(i._dfr=yt(i._dfr,"/"+r+u))}function kr(n){var r,f,t,u;if(u=a(n,!0,hu))for(r=0,f=u.length;r<f;r++)t=u[r],t.ch==="_"?(t=p[t.id])&&t.type&&t.parent.removeViews(t._.key,i,!0):bt(t.id)}function gu(n,t,i){if(i.change==="set"){for(var r=n.tgt,u=r.length;u--;)if(r[u].key===i.path)break;u===-1?i.path&&f(r).insert({key:i.path,prop:i.value}):i.remove?f(r).remove(u):f(r[u]).setProperty("prop",i.value)}}function nf(n,t,i){var r,u=n.src,e=i.change;e==="set"?i.path==="prop"?f(u).setProperty(t.target.key,i.value):(f(u).setProperty(i.oldValue,null),delete u[i.oldValue],f(u).setProperty(i.value,t.target.prop)):e==="remove"?(r=i.items[0],f(u).removeProperty(r.key),delete u[r.key]):e==="insert"&&(r=i.items[0],r.key&&f(u).setProperty(r.key,r.prop))}function tf(n){return n.indexOf(".")<0}var kt="JsViews requires ",g,nt,it,dr,dt,rt,gr,bi,ki,tt,v,ut,ft,o,y,p,e=n.document,r=t.views,u=r.sub,c=r.settings,w=u.extend,et=t.isFunction,nu=r.converters,b=r.tags,f=t.observable,ot=f.observe,s="data-jsv",di=u.propChng=u.propChng||"propertyChange",gt=u.arrChng=u.arrChng||"arrayChange",gi="change.jsv",ni="onBeforeChange",ti="onAfterChange",tu="onAfterCreate",k="checked",ii="checkbox",st="radio",ht="none",ct="true",nr='"><\/script>',tr='<script type="jsv',ri="script,["+s+"]",l="html",ui={value:"val",input:"val",html:l,text:"text"},ir={from:"value",to:"value"},fi=0,iu=t.cleanData,ru=c.delimiters,ei=u.syntaxErr,uu=/<(?!script)(\w+)(?:[^>]*(on\w+)\s*=)?[^>]*>/,fu=/['"\\]/g,rr=e.createDocumentFragment(),oi=e.querySelector,si={ol:1,ul:1,table:1,tbody:1,thead:1,tfoot:1,tr:1,colgroup:1,dl:1,select:1,optgroup:1,svg:1,svg_ns:1},eu={tr:"table"},hi={br:1,img:1,input:1,hr:1,area:1,base:1,col:1,link:1,meta:1,command:1,embed:1,keygen:1,param:1,source:1,track:1,wbr:1},ur={},h={},fr=1,ou=/^#(view\.?)?/,su=/(^|(\/>)|<\/(\w+)>|)(\s*)([#\/]\d+[_^])`(\s*)(<\w+(?=[\s\/>]))?|\s*(?:(<\w+(?=[\s\/>]))|<\/(\w+)>(\s*)|(\/>)\s*|(>))/g,er=/(#)()(\d+)(_)/g,hu=/(#)()(\d+)([_^])/g,cu=/(?:(#)|(\/))(\d+)(_)/g,lu=/(#)()(\d+)(\^)/g,au=/(?:(#)|(\/))(\d+)([_^])([-+@\d]+)?/g,or=n.getComputedStyle;if(!t)throw kt+"jQuery";if(!r)throw kt+"JsRender";if(!f)throw kt+"jquery.observable";t.link||(ut={contents:function(n,r){n!==!!n&&(r=n,n=i);var f,u=t(this.nodes());return u[0]&&(f=r?u.filter(r):u,u=n&&r?f.add(u.find(r)):f),u},nodes:function(n,t,i){var r,u=this,f=u._elCnt,o=!t&&f,e=[];for(t=t||u._prv,i=i||u._nxt,r=o?t===u._nxt?u.parentElem.lastSibling:t:u._.inline===!1?t||u.linkCtx.elem.firstChild:t&&t.nextSibling;r&&(!i||r!==i);)(n||f||r.tagName!=="SCRIPT")&&e.push(r),r=r.nextSibling;return e},childTags:function(n,t){n!==!!n&&(t=n,n=i);var r=this,o=r.link?r:r.tagCtx.view,u=r._prv,f=r._elCnt,e=[];return u&&o.link(i,r.parentElem,f?u.previousSibling:u,r._nxt,i,{get:{tags:e,deep:n,name:t,id:f&&r._tgId}}),e},refresh:function(n){var u,f,t=this,e=t.linkCtx,o=t.tagCtx.view;return t.disposed&&tt("Removed tag"),n===i&&(n=r._tag(t,o,o.tmpl,wr(t),!0)),n+""===n&&(f=t._.inline?l:e.attr||lt(t.parentElem,!0),u=sr(n,e,f,t)),pt(t,t.tagCtx),u||t},update:function(n){var t=this.linkedElem;t&&d({target:t[0]},i,n)}},u.onStore.template=function(n,i){i.link=lr;i.unlink=br;n&&(t.link[n]=function(){return lr.apply(i,arguments)},t.unlink[n]=function(){return br.apply(i,arguments)})},u.onStore.tag=function(n,t){u._lnk(t)},u._lnk=function(n){return w(n,ut)},u.viewInfos=a,(c.delimiters=function(){var n=ru.apply(r,arguments);return dr=n[0],dt=n[1],rt=n[2],gr=n[3],bi=n[4],it=new RegExp("(?:^|\\s*)([\\w-]*)(\\"+bi+")?(\\"+dt+u.rTag+"\\"+rt+")","g"),this})(),w(u._lnk(u.View.prototype),{addViews:function(n,t,i){var u,s,r=this,e=t.length,o=r.views;if(!r._.useKey&&e&&(i=r.tmpl)&&(s=o.length+e,cr(r,n,i,o,t,r.ctx)!==!1))for(u=n+e;u<s;u++)f(o[u]).setProperty("index",u);return r},removeViews:function(n,r,u){function s(n){var s,h,c,f,o,l,r=e[n];if(r&&r.link){if(s=r._.id,u||(l=r.nodes()),r.removeViews(i,i,!0),r.type=i,f=r._prv,o=r._nxt,c=r.parentElem,u||(r._elCnt&&wi(f,o,c,s,"_"),t(l).remove()),!r._elCnt)try{f.parentNode.removeChild(f);o.parentNode.removeChild(o)}catch(a){}ci(r);for(h in r._.bnds)bt(h);delete p[s]}}var o,a,h,c=this,l=!c._.useKey,e=c.views;if(l&&(h=e.length),n===i)if(l){for(o=h;o--;)s(o);c.views=[]}else{for(a in e)s(a);c.views={}}else if(r===i&&(l?r=1:(s(n),delete e[n])),l&&r){for(o=n+r;o-->n;)s(o);if(e.splice(n,r),h=e.length)while(n<h)f(e[n]).setProperty("index",n++)}return this},refresh:function(n){var t=this,i=t.parent;return i&&(cr(t,t.index,t.tmpl,i.views,t.data,n,!0),ci(t)),t},link:pu}),p={0:y=new u.View(i,"top")},nu.merge=function(n){var t,i=this.linkCtx._val||"",r=this.tagCtx.props.toggle;return r&&(t=r.replace(/[\\^$.|?*+()[{]/g,"\\$&"),t="(\\s(?="+t+"$)|(\\s)|^)("+t+"(\\s|$))",i=i.replace(new RegExp(t),"$2"),n=i+(n?(i&&" ")+r:"")),n},b("on",{attr:ht,onAfterLink:function(n,r){for(var l,o,s=this,h=0,f=n.args,v=f.length,a=n.props.data,c=n.view,e=n.props.context;h<v&&!(o=et(l=f[h++])););if(o){o=f.slice(h);f=f.slice(0,h-1);e||(e=/^(.*)[\.^][\w$]+$/.exec(n.params.args.slice(-o.length-1)[0]),e=e&&u.tmplFn("{:"+e[1]+"}",c.tmpl,!0)(r.data,c));s._evs&&s.onDispose();t(r.elem).on(s._evs=f[0]||"click",s._sel=f[1],a==i?null:a,s._hlr=function(n){return l.apply(e||r.data,[].concat(o,n,{change:n.type,view:c,linkCtx:r}))})}},onDispose:function(){t(this.parentElem).off(this._evs,this._sel,this._hlr)},flow:!0}),w(b["for"],{onArrayChange:function(n,t){var i,r=this,u=t.change;if(r.tagCtxs[1]&&(u==="insert"&&n.target.length===t.items.length||u==="remove"&&!n.target.length||u==="refresh"&&!t.oldItems.length!=!n.target.length))r.refresh();else for(i in r._.arrVws)i=r._.arrVws[i],i.data===n.target&&i._.onArrayChange.apply(i,arguments);n.done=!0},onAfterLink:function(){for(var u,o,i,f,e=this,r=e._ars||{},s=e.tagCtxs,c=s.length,h=e.selected||0,n=0;n<=h;n++)u=s[n],f=u.map?u.map.tgt:u.args.length?u.args[0]:u.view.data,(i=r[n])&&f!==i[0]&&(ot(i[0],i[1],!0),delete r[n]),!r[n]&&t.isArray(f)&&(ot(f,o=function(n,t){e.onArrayChange(n,t)}),r[n]=[f,o]);for(n=h+1;n<c;n++)(i=r[n])&&(ot(i[0],i[1],!0),delete r[n]);e._ars=r},onDispose:function(){var n,t=this;for(n in t._ars)ot(t._ars[n][0],t._ars[n][1],!0)}}),w(b["for"],ut),w(b["if"],ut),w(b.include,ut),b("props",{baseTag:b["for"],dataMap:r.map({getTgt:b.props.dataMap.getTgt,obsSrc:gu,obsTgt:nf,tgtFlt:tf})}),w(t,{view:r.view=nt=function(n,r,u){function w(n,t){if(n)for(o=a(n,t,er),c=0,b=o.length;c<b;c++)if((f=p[o[c].id])&&(f=f&&u?f.get(!0,u):f))break}r!==!!r&&(u=r,r=i);var f,o,h,c,b,s,l,v=0,k=e.body;if(n&&n!==k&&y._.useKey>1&&(n=""+n===n?t(n)[0]:n.jquery?n[0]:n,n)){if(r){if(w(n._dfr,!0),!f)for(l=oi?n.querySelectorAll(ri):t(ri,n).get(),s=l.length,h=0;!f&&h<s;h++)w(l[h]);return f}while(n){if(o=a(n,i,cu))for(s=o.length;s--;)if(f=o[s],f.open){if(v<1)return f=p[f.id],f&&u?f.get(u):f||y;v--}else v++;n=n.previousSibling||n.parentNode}}return y},link:r.link=ai,unlink:r.unlink=pi,cleanData:function(n){n.length&&fi&&wt(n);iu.apply(t,arguments)}}),r.utility={validate:function(n){try{y.link(i,e.createElement("div"),i,i,n,i,i,1)}catch(t){return t.message}}},w(t.fn,{link:function(n,t,i,r,u,f,e){return ai(n,this,t,i,r,u,f,e)},unlink:function(n){return pi(n,this)},view:function(n){return nt(this[0],n)}}),t.each([l,"replaceWith","empty","remove"],function(n,i){var r=t.fn[i];t.fn[i]=function(){var n;fi=1;try{n=r.apply(this,arguments)}finally{fi=0}return n}}),w(y,{tmpl:{links:{},tags:{}}}),y._.onRender=at,c({wrapMap:o={option:[1,"<select multiple='multiple'>","<\/select>"],legend:[1,"<fieldset>","<\/fieldset>"],area:[1,"<map>","<\/map>"],param:[1,"<object>","<\/object>"],thead:[1,"<table>","<\/table>"],tr:[2,"<table><tbody>","<\/tbody><\/table>"],td:[3,"<table><tbody><tr>","<\/tr><\/tbody><\/table>"],col:[2,"<table><tbody><\/tbody><colgroup>","<\/colgroup><\/table>"],svg_ns:[1,"<svg>","<\/svg>"],div:jQuery.support.htmlSerialize?[0,"",""]:[1,"X<div>","<\/div>"]},linkAttr:v="data-link",merge:{input:{from:du,to:"value"},textarea:ir,select:ir,optgroup:{to:"label"}},jsrDbgMode:c.debugMode,debugMode:function(t){c.jsrDbgMode(t);t?n._jsv={views:p,bindings:h}:delete n._jsv},jsv:function(){c.debugMode(c._dbgMode);v=c.linkAttr;tt=r._err;ft=ri+",["+v+"]";ki=c.noDomLevel0;o.optgroup=o.option;o.tbody=o.tfoot=o.colgroup=o.caption=o.thead;o.th=o.td}}))})(this,this.jQuery);
/*
//# sourceMappingURL=jquery.views.min.js.map
*/