/*! JsViews v1.0.0-alpha: http://github.com/BorisMoore/jsviews and http://jsviews.com/jsviews
informal pre V1.0 commit counter: 56 (Beta Candidate) */
(function(n,t,i){"use strict";function k(n,r,u){var w,nt,l,e,b,a,o,k,s,v,it,d,g,f,c,y,p=n.target,rt=p._jsvBnd,ut=/&(\d+)\+?/g;if(rt)while(v=ut.exec(rt))if((v=h[v[1]])&&(c=v.to)){if(e=v.linkCtx,s=e.view,f=e.tag,k=t(p),d=s.hlp(gt),g=s.hlp(ni),l=lt(p),w=ri[l],u===i&&(u=et(l)?l(p):w?k[w]():k.attr(l)),a=c[1],c=c[0],a&&(b=et(a)?a:s.getRsc("converters",a)),b&&(u=b.call(f,u)),it=s.linkCtx,s.linkCtx=e,y={change:"change",oldValue:e._val,value:u},(!d||!(nt=d.call(e,n,y)===!1))&&(!f||!f.onBeforeChange||!(nt=f.onBeforeChange(n,y)===!1))&&u!==i&&(o=c[0],u!==i&&o)){if(o=o._jsvOb?o._ob:o,f&&(f._.chging=!0),tt(o).setProperty(c[2]||c[1],u),g&&g.call(e,n,y),f){if(f.onAfterChange)f.onAfterChange(n,y);delete f._.chging}e._val=u}s.linkCtx=it}}function vu(n,t,u){var c,f,e,p,o=this,y=o.data,a=o.elem,l=o.convert,b=a.parentNode,h=o.view,w=h.linkCtx,v=h.hlp(gt);if(h.linkCtx=o,b&&(!v||!(t&&v.call(o,n,t)===!1))&&!(t&&n.data.prop!=="*"&&n.data.prop!==t.path)){if(t&&(o.eventArgs=t),t||o._initVal){if(delete o._initVal,f=u.call(h.tmpl,y,h,r),c=yu(f,o,e=o.tag,o.attr||lt(a,!0,l!==i)),f&&f.error!==i)f=f.error;else if(e){if(f=f[0]?f:[f],p=t&&e.onUpdate&&e.onUpdate(n,t,f)===!1,wr(e,f),p||c===ht){c===s&&e.onBeforeLink&&e.onBeforeLink();yt(e,e.tagCtx);li(o,y,a);h.linkCtx=w;return}if(e._.chging)return;f=e.tagName===":"?r._cnvt(e.cvt,h,f[0]):r._tag(e,h,h.tmpl,f,!0)}else u._tag&&(l=l===""?ct:l,f=l?r._cnvt(l,h,f):r._tag(u._tag,h,h.tmpl,f,!0),e=o.tag,c=o.attr||c);sr(f,o,c,e)&&t&&(v=h.hlp(ni))&&v.call(o,n,t);e&&yt(e,e.tagCtx)}li(o,y,a);h.linkCtx=w}}function yu(n,r,u,f){var e,h,c,o,s=u&&u.parentElem||r.elem;if(n!==i){if(o=t(s),f=u&&u.attr||f,et(n)&&nt(r.expr+": missing parens"),f==="visible"&&(f="css-display"),c=/^css-/.test(f)&&f.slice(4))e=t.style(s,c),+n===n&&(e=parseInt(e));else if(f!=="link"){if(f==="value")s.type===ti&&(e=o.prop(f=b));else if(f===st)if(s.value===""+n)e=o.prop(b);else return f;e===i&&(h=ri[f],e=h?o[h]():o.attr(f))}r._val=e}return f}function sr(r,u,e,o){var et,c,a,nt,ot,d,y,g,p,w,k,tt,it,rt=r!==i,ct=u.data,h=o&&o.parentElem||u.elem,ut=t(h),l=u.view,ft=u._val,lt=l.ctx,at=l.linkCtx,v=o||e===s;if(o&&(o.parentElem=o.parentElem||u.expr||o._elCnt?h:h.parentNode,c=o._prv,a=o._nxt),!rt){e===s&&o&&o.onBeforeLink&&o.onBeforeLink();return}if(/^css-/.test(e))u.attr==="visible"&&(it=(h.currentStyle||or.call(n,h,"")).display,r?(r=h._jsvd||it,r!==ht||(r=ur[tt=h.nodeName])||(k=f.createElement(tt),f.body.appendChild(k),r=ur[tt]=(k.currentStyle||or.call(n,k,"")).display,f.body.removeChild(k))):(h._jsvd=it,r=ht)),(v=v||ft!==r)&&t.style(h,e.slice(4),r);else if(e!=="link"){if(e===b)d=1,r=r&&r!=="false";else if(e===st)if(h.value===""+r)r=!0,d=1,e=b;else{li(u,ct,h);return}else(e==="selected"||e==="disabled"||e==="multiple"||e==="readonly")&&(r=r&&r!=="false"?e:null);(et=ri[e])?e===s?(l.linkCtx=u,l.ctx=u.ctx,o&&o._.inline?(ot=o.nodes(!0),o._elCnt&&(c&&c!==a?wi(c,a,h,o._tgId,"^",!0):(y=h._dfr)&&(g=o._tgId+"^",p=y.indexOf("#"+g)+1,w=y.indexOf("/"+g),p&&w>0&&(p+=g.length,w>p&&(h._dfr=y.slice(0,p)+y.slice(w),kr(y.slice(p,w))))),c=c?c.previousSibling:a?a.previousSibling:h.lastChild),t(ot).remove(),o&&o.onBeforeLink&&o.onBeforeLink(),nt=l.link(l.data,h,c,a,r,o&&{tag:o._tgId,lazyLink:o.tagCtx.props.lazyLink})):(rt&&ut.empty(),o&&o.onBeforeLink&&o.onBeforeLink(),rt&&(nt=l.link(ct,h,c,a,r,o&&{tag:o._tgId}))),l.linkCtx=at,l.ctx=lt):(v=v||ft!==r)&&(e==="text"&&h.children&&!h.children[0]?h.textContent!==i?h.textContent=r:h.innerText=r===null?"":r:ut[et](r)):(v=v||ft!==r)&&ut[d?"prop":"attr"](e,r===i&&!d?null:r);u._val=r}return nt||v}function hr(n,t){var i=this,r=i.hlp(gt),u=i.hlp(ni);if(!r||r.call(this,n,t)!==!1){if(t){var o=t.change,f=t.index,e=t.items;switch(o){case"insert":i.addViews(f,e);break;case"remove":i.removeViews(f,e.length);break;case"move":i.refresh();break;case"refresh":i.refresh()}}u&&u.call(this,n,t)}}function hi(n){var f,e,u=n.data,r=n._.bnd;if(!n._.useKey&&r)if((e=n._.bndArr)&&(t([e[1]]).off(dt,e[0]),n._.bndArr=i),r!==!!r&&r._.inline)u?r._.arrVws[n._.id]=n:delete r._.arrVws[n._.id];else if(u){f=function(t){t.data&&t.data.off||hr.apply(n,arguments)};t([u]).on(dt,f);n._.bndArr=[f,u]}}function lt(n,t,i){var u=n.nodeName.toLowerCase(),r=c.merge[u]||n.contentEditable===ct&&{to:s,from:s};return r?t?u==="input"&&n.type===st?st:r.to:r.from:t?i?"text":s:""}function cr(n,r,u,f,e,o,s){var p,c,v,w,b,l=n.parentElem,h=n._prv,a=n._nxt,y=n._elCnt;if(h&&h.parentNode!==l&&nt("Missing parentNode"),s){w=n.nodes();y&&h&&h!==a&&wi(h,a,l,n._.id,"_",!0);n.removeViews(i,i,!0);c=a;y&&(h=h?h.previousSibling:a?a.previousSibling:l.lastChild);t(w).remove();for(b in n._.bnds)wt(b)}else{if(r){if(v=f[r-1],!v)return!1;h=v._nxt}y?(c=h,h=c?c.previousSibling:l.lastChild):c=h.nextSibling}p=u.render(e,o,n._.useKey&&s,n,s||r,!0);n.link(e,l,h,c,p,v)}function ci(n,t,r){var u,f,e;return r?(e="^`",f=t._.tag||{_:{inline:!0,bnd:r},tagCtx:{view:t},flow:!0},u=f._tgId,u||(h[u=fr++]=f,f._tgId=""+u)):(e="_`",v[u=t._.id]=t),"#"+u+e+(n!=i?n:"")+"/"+u+e}function li(n,t,r){var e,l,f,u=n.tag,a=n.convertBack,s=[],c=n._bndId||""+fr++,v=n._hdlr;if(delete n._bndId,u&&(s=u.depends||s,s=et(s)?u.depends(u):s,f=u.linkedElem),(!n._depends||""+n._depends!=""+s)&&(n._depends&&tt._apply(!1,[t],n._depends,v,!0),e=tt._apply(!1,[t],n.fn.paths,s,v,n._ctxCb),e.elem=r,e.linkCtx=n,e._tgId=c,r._jsvBnd=r._jsvBnd||"",r._jsvBnd+="&"+c,n._depends=s,n.view._.bnds[c]=c,h[c]=e,f&&(e.to=[[],a]),(f||a!==i)&&pr(e,u&&u.convertBack||a),u)){if(u.onAfterBind)u.onAfterBind(e);u.flow||u._.inline||(r.setAttribute(o,(r.getAttribute(o)||"")+"#"+c+"^/"+c+"^"),u._tgId=""+c)}if(f&&f[0])for(u._.radio&&(f=f.children("input[type=radio]")),l=f.length;l--;)f[l]._jsvBnd=f[l]._jsvBnd||r._jsvBnd+"+",f[l]._jsvLnkdEl=u}function lr(n,t,i,r,u,f,e){return ai(this,n,t,i,r,u,f,e)}function ai(n,r,u,e,o,s,h,c){if(n&&r){if(r=r.jquery?r:t(r),!d){d=f.body;t(d).on(gi,k).on("blur","[contenteditable]",k)}for(var p,nt,tt,b,y,w,a,it,rt=ci,ft=e&&e.target==="replace",ut=r.length;ut--;)if(a=r[ut],""+n===n)y=g(a),it=y.ctx,y.ctx=e,at(n,a,y,u),y.ctx=it;else{if(s=s||g(a),n.markup!==i)s.link===!1&&(e=e||{},e.link=rt=!1),ft&&(w=a.parentNode),tt=n.render(u,e,o,s,i,rt),w?(h=a.previousSibling,c=a.nextSibling,t.cleanData([a],!0),w.removeChild(a),a=w):(h=c=i,t(a).empty());else if(n!==!0)break;if(a._dfr&&!c){for(b=l(a._dfr,1,er),p=0,nt=b.length;p<nt;p++)y=b[p],(y=v[y.id])&&y.data!==i&&y.parent.removeViews(y._.key,i,!0);a._dfr=""}s.link(u,a,h,c,tt,i,e)}}return r}function pu(n,r,u,s,y,w,b,k){function ou(n,t,r,u,f,e,s,h,c,l,a,v,p){var w,b="";return p?(ri=0,n):(d=h||c||"",u=u||l,r=r||v,ai&&!r&&(u||d||e)&&(ai=i,rt=dt.shift()),u=u||r,u&&(ri=0,ai=i,wr&&(r||v?si[rt]||/;svg;|;math;/.test(";"+dt.join(";")+";")||(w="'<"+rt+".../"):si[u]?w="'<\/"+u:dt.length&&u===rt||(w="Mismatch: '<\/"+u),w&&fi(w+">' in:\n"+y)),ur=ut,rt=dt.shift(),ut=oi[rt],l=l?"<\/"+l+">":"",ur&&(ht+=pt,pt="",ut?ht+="-":(b=l+tr+"@"+ht+nr+(a||""),ht=ru.shift()))),ut?(e?pt+=e:t=l||v||"",d&&(t+=d,pt&&(t+=" "+o+'="'+pt+'"',pt=""))):t=e?t+b+f+tr+e+nr+s+d:b||n,ri&&e&&fi(" No {^{ tags within elem markup ("+ri+' ). Use data-link="..."'),d&&(ri=d,dt.unshift(rt),rt=d.slice(1),dt[0]&&dt[0]===eu[rt]&&nt("Parent of <tr> must be <tbody>"),ai=si[rt],(ut=oi[rt])&&!ur&&(ru.unshift(ht),ht=""),ur=ut,ht&&ut&&(ht+="+")),t)}function pi(n,t){var o,l,u,e,f,a,s,c=[];if(n){for(n._tkns.charAt(0)==="@"&&(t=tt.previousSibling,tt.parentNode.removeChild(tt),tt=i),bt=n.length;bt--;){if(ot=n[bt],u=ot.ch,o=ot.path)for(et=o.length-1;l=o.charAt(et--);)l==="+"?o.charAt(et)==="-"?(et--,t=t.previousSibling):t=t.parentNode:t=t.lastChild;u==="^"?(d=h[f=ot.id])&&(s=t&&(!tt||tt.parentNode!==t),(!tt||s)&&(d.parentElem=t),ot.elCnt&&s&&(t._dfr=(ot.open?"#":"/")+f+u+(t._dfr||"")),c.push([s?null:tt,ot])):(it=v[f=ot.id])&&(it.parentElem||(it.parentElem=t||tt&&tt.parentNode||r,it._.onRender=ci,it._.onArrayChange=hr,hi(it)),e=it.parentElem,ot.open?(it._elCnt=ot.elCnt,t?t._dfr="#"+f+u+(t._dfr||""):(it._prv||(e._dfr=vt(e._dfr,"#"+f+u)),it._prv=tt)):(t&&(!tt||tt.parentNode!==t)?(t._dfr="/"+f+u+(t._dfr||""),it._nxt=i):tt&&(it._nxt||(e._dfr=vt(e._dfr,"/"+f+u)),it._nxt=tt),ui=it.linkCtx,(a=it.ctx&&it.ctx.onAfterCreate||cu)&&a.call(ui,it)))}for(bt=c.length;bt--;)yi.push(c[bt])}return!n||n.elCnt}function hu(n){var t,i;if(n)for(bt=n.length,et=0;et<bt;et++)if(ot=n[et],lt.id)lt.id=lt.id!==ot.id&&lt.id;else if(i=d=h[ot.id].linkCtx.tag,!d.flow){if(!lr){for(t=1;i=i.parent;)t++;gi=gi||t}(lr||t===gi)&&(!ar||d.tagName===ar)&&cr.push(d)}}function kr(){for(or=ei?r.querySelectorAll(ft):t(ft,r).get(),ni=or.length,u&&u.innerHTML&&(wi=ei?u.querySelectorAll(ft):t(ft,u).get(),u=wi.length?wi[wi.length-1]:u),gi=0,wt=0;wt<ni;wt++)if(tt=or[wt],u&&!nu)nu=tt===u;else if(s&&tt===s)break;else tt.parentNode&&fu(l(tt,i,cr&&lu))&&!lt&&tt.getAttribute(a)&&yi.push([tt]);if(er===p&&y===i&&r.getAttribute(a)&&yi.push([r]),vr(u,ut),vr(s,ut),lt){kt&&kt.resolve();return}for(ut&&ht+pt&&(tt=s,ht&&(s?pi(l(ht+"+",1),s):pi(l(ht,1),r)),pi(l(pt,1),r),s&&(st=s.getAttribute(o),(ni=st.indexOf(fr)+1)&&(st=st.slice(ni+fr.length-1)),s.setAttribute(o,pt+st))),ni=yi.length,wt=0;wt<ni;wt++)tt=yi[wt],gt=tt[1],tt=tt[0],gt?(d=h[gt.id])&&((ui=d.linkCtx)&&(d=ui.tag,d.linkCtx=ui),gt.open?(tt&&(d.parentElem=tt.parentNode,d._prv=tt),d._elCnt=gt.elCnt,!d||d.onBeforeLink&&d.onBeforeLink()===!1||d._.bound||(d._.bound=!0,it=d.tagCtx.view,at(i,d._prv,it,n,gt.id)),d._.linking=!0):(d._nxt=tt,d._.linking&&(pr=d.tagCtx,it=pr.view,delete d._.linking,d._.bound||(d._.bound=!0,at(i,d._prv,it,n,gt.id)),yt(d,pr)))):(it=g(tt),at(tt.getAttribute(a),tt,it,n,i,b));kt&&kt.resolve()}var ri,ui,d,wt,ni,et,bt,or,tt,it,ot,gt,wi,bi,sr,di,ti,cr,lr,ar,pr,wr,gi,lt,dr,br,gr,li,rt,ai,vi,ir,st,ut,ur,ii,pt,fr,nu,kt,er=this,iu=er._.id+"_",ht="",yi=[],dt=[],ru=[],cu=er.hlp(tu),fu=pi;if(w&&(kt=w.lazyLink&&t.Deferred(),w.tmpl?sr="/"+w._.id+"_":(lt=w.get,w.tag&&(iu=w.tag+"^",w=!0)),w=w===!0),lt&&(fu=hu,cr=lt.tags,lr=lt.deep,ar=lt.name),r=r?""+r===r?t(r)[0]:r.jquery?r[0]:r:er.parentElem||f.body,wr=!c.noValidate&&r.contentEditable!==ct,rt=r.tagName.toLowerCase(),ut=!!oi[rt],u=u&&yr(u,ut),s=s&&yr(s,ut)||null,y!=i){if(ir=f.createElement("div"),vi=ir,fr=pt="",ii=r.namespaceURI==="http://www.w3.org/2000/svg"?"svg_ns":(li=uu.exec(y))&&li[1]||"",ki&&li&&li[2]&&nt("Unsupported: "+li[2]),ut){for(ti=s;ti&&!(di=l(ti));)ti=ti.nextSibling;(st=di?di._tkns:r._dfr)&&(bi=sr||"",(w||!sr)&&(bi+="#"+iu),et=st.indexOf(bi),et+1&&(et+=bi.length,fr=pt=st.slice(0,et),st=st.slice(et),di?ti.setAttribute(o,st):r._dfr=st))}if(ai=i,y=(""+y).replace(su,ou),wr&&dt.length&&fi("Mismatched '<"+rt+"...>' in:\n"+y),k)return;for(rr.appendChild(ir),ii=e[ii]||e.div,dr=ii[0],vi.innerHTML=ii[1]+y+ii[2];dr--;)vi=vi.lastChild;for(rr.removeChild(ir),br=f.createDocumentFragment();gr=vi.firstChild;)br.appendChild(gr);r.insertBefore(br,s)}return kt?setTimeout(kr,0):kr(),kt&&kt.promise()}function at(n,t,r,f,e,o){var b,v,p,c,k,d,y,w,a,l,g;if(f=r.data===i?f||{}:r.data,e)l=h[e],l=l.linkCtx?l.linkCtx.tag:l,a=l.linkCtx||{data:f,elem:l._elCnt?l.parentElem:t,view:r,ctx:r.ctx,attr:s,fn:l._.bnd,tag:l,_bndId:e},ar(a,a.fn);else if(n&&t)for(b=r.tmpl,n=wu(n,lt(t)),it.lastIndex=0;v=it.exec(n);)g=it.lastIndex,p=e?s:v[1],y=v[3],k=v[10],c=i,a={data:f,elem:t,view:r,ctx:o||r.ctx,attr:p,_initVal:!v[2]},v[6]&&(!p&&(c=/:([\w$]*)$/.exec(k))&&(c=c[1],c!==i&&(d=-c.length-1,y=y.slice(0,d-1)+rt)),c===null&&(c=i),a.convert=v[5]||""),a.expr=p+y,w=b.links[y],w||(b.links[y]=w=u.tmplFn(y,b,!0,c)),a.fn=w,p||c===i||(a.convertBack=c),ar(a,w),it.lastIndex=g}function ar(n,t){function i(i,r){vu.call(n,i,r,t)}i.noArray=!0;n._ctxCb=ku(n.view);n._hdlr=i;i(!0)}function vt(n,t){var i;return n?(i=n.indexOf(t),i+1?n.slice(0,i)+n.slice(i+t.length):n):""}function vi(n){return n&&(""+n===n?n:n.tagName==="SCRIPT"?n.type.slice(3):n.nodeType===1&&n.getAttribute(o)||"")}function l(n,t,i){function e(n,t,i,r,e,o){u.push({elCnt:f,id:r,ch:e,open:t,close:i,path:o,token:n})}var f,r,u=[];if(r=t?n:vi(n))return u.elCnt=!n.type,f=r.charAt(0)==="@"||!n.type,u._tkns=r,r.replace(i||au,e),u}function vr(n,t){n&&(n.type==="jsv"?n.parentNode.removeChild(n):t&&n.getAttribute(a)===""&&n.removeAttribute(a))}function yr(n,t){for(var i=n;t&&i&&i.nodeType!==1;)i=i.previousSibling;return i&&(i.nodeType!==1?(i=f.createElement("SCRIPT"),i.type="jsv",n.parentNode.insertBefore(i,n)):vi(i)||i.getAttribute(a)||i.setAttribute(a,"")),i}function wu(n,i){return n=t.trim(n).replace(fu,"\\$&"),n.slice(-1)!==rt?n=kt+":"+n+(i?":":"")+rt:n}function yt(n,r){var e,f,l,o,s,y,p,a,w,v,k=r.view,c=n.linkCtx=n.linkCtx||{tag:n,data:k.data,view:k,ctx:k.ctx};if(n.onAfterLink)n.onAfterLink(r,c);if(e=n.targetTag?n.targetTag.linkedElem:n.linkedElem,(f=e&&e[0])&&((l=n._.radio)&&(e=e.children("input[type=radio]")),l||!n._.chging)){if(o=u.cvt(n,n.convert)[0],l||f!==c.elem){for(p=e.length;p--;){if(f=e[p],a=f._jsvLnkdEl,n._.inline&&(!a||a!==n&&a.targetTag!==n))for(f._jsvLnkdEl=n,s=c.elem?c.elem._jsvBnd:n._prv._jsvBnd,f._jsvBnd=s+"+",s=s.slice(1).split("&"),y=s.length;y--;)pr(h[s[y]],n.convertBack);l&&(f[b]=o===f.value)}c._val=o}o!==i&&(l||f.value===i?f.contentEditable===ct&&(f.innerHTML=o):f.type===ti?f[b]=o&&o!=="false":e.val(o))}(f=f||n.tagName===":"&&c.elem)&&(w=f._jsvTr,v=r.props.trigger,w!==v&&(f._jsvTr=v,e=e||t(f),yi(e,w,"off"),yi(e,v,"on")))}function bu(n){setTimeout(function(){k(n)},0)}function yi(n,t,i){t&&n[i](t===!0?"keydown":t,t===!0?bu:k)}function pr(n,t){var e,f,s,i,o,r=n.linkCtx,h=r.data,u=r.fn.paths;if(n){for((e=u._jsvto)&&(u=e),f=u.length;f&&""+(i=u[--f])!==i;);i&&(!r.tag||r.tag.tagCtx.args.length)?(i=i.split("^").join("."),n.to=i.charAt(0)==="."?[[o=u[f-1],i.slice(1)],t]:[r._ctxCb(s=f?u[0].split("^").join("."):i)||[h,s],t],e&&o&&(n.to[0][0]=r._ctxCb(o,h))):n.to=[[],t]}}function wr(n,i){var u,f,e=n.tagCtx.view,o=n.tagCtxs||[n.tagCtx],s=o.length,h=!i;for(i=i||n._.bnd.call(e.tmpl,(n.linkCtx||e).data,e,r);s--;)u=o[s],f=i[s],t.observable(u.props).setProperty(f.props),y(u.ctx,f.ctx),u.args=f.args,h&&(u.tmpl=f.tmpl);return o}function pt(n){for(var u,t,i,f=[],e=n.length,r=e;r--;)f.push(n[r]);for(r=e;r--;)if(t=f[r],t.parentNode){if(i=t._jsvBnd)for(i=i.slice(1).split("&"),t._jsvBnd="",u=i.length;u--;)wt(i[u],t._jsvLnkdEl,t);kr(vi(t)+(t._dfr||""))}}function wt(n,r,f){var y,c,e,l,a,p,w,b,v,s,k,o=h[n];if(r)f===r.linkedElem[0]&&(delete f._jsvLnkdEl,delete r.linkedElem);else if(o){delete h[n];for(y in o.bnd)l=o.bnd[y],a=".obs"+o.cbId,t.isArray(l)?t([l]).off(dt+a).off(di+a):t(l).off(di+a),delete o.bnd[y];if(c=o.linkCtx){if(e=c.tag){if(p=e.tagCtxs)for(w=p.length;w--;)(b=p[w].map)&&b.unmap();v=e.linkedElem;s=v&&v[0]||c.elem;(k=s&&s._jsvTr)&&(yi(v||t(s),k,"off"),s._jsvTr=i);e.onDispose&&e.onDispose();e._elCnt||(e._prv&&e._prv.parentNode.removeChild(e._prv),e._nxt&&e._nxt.parentNode.removeChild(e._nxt))}delete c.view._.bnds[n]}delete u._cbBnds[o.cbId]}}function pi(n,r){return n===i?(d&&(t(d).off(gi,k).off("blur","[contenteditable]",k),d=i),n=!0,p.removeViews(),pt(f.body.getElementsByTagName("*"))):r&&n===!0&&(r=r.jquery?r:t(r),r.each(function(){for(var n;(n=g(this,!0))&&n.parent;)n.parent.removeViews(n._.key,i,!0);pt(this.getElementsByTagName("*"));pt([this])})),r}function br(n,t){return pi(this,n,t)}function ku(n){return n=n||t.view(),function(t,i){var f,u,e=[i];if(n&&t){if(t._jsvOb)return t._jsvOb.call(n.tmpl,i,n,r);if(t.charAt(0)==="~")return t.slice(0,4)==="~tag"&&(u=n.ctx,t.charAt(4)==="."&&(f=t.slice(5).split("."),u=u.tag),f)?u?[u,f.join("."),i]:[]:(t=t.slice(1).split("."),(i=n.hlp(t.shift()))&&(t.length&&e.unshift(t.join(".")),e.unshift(i)),i?e:[]);if(t.charAt(0)==="#")return t==="#data"?[]:[n,t.replace(ou,""),i]}}}function du(n){return n.type===ti?n[b]:n.value}function wi(n,t,i,r,u,f){var y,c,p,s,b,a,e,w=0,k=n===t;if(n){for(p=l(n)||[],y=0,c=p.length;y<c;y++){if(s=p[y],a=s.id,a===r&&s.ch===u)if(f)c=0;else break;k||(b=s.ch==="_"?v[a]:h[a].linkCtx.tag,s.open?b._prv=t:s.close&&(b._nxt=t));w+=a.length+2}w&&n.setAttribute(o,n.getAttribute(o).slice(w));e=t?t.getAttribute(o):i._dfr;(c=e.indexOf("/"+r+u)+1)&&(e=p._tkns.slice(0,w)+e.slice(c+(f?-1:r.length+1)));e&&(t?t.setAttribute(o,e):i._dfr=e)}else i._dfr=vt(i._dfr,"#"+r+u),f||t||(i._dfr=vt(i._dfr,"/"+r+u))}function kr(n){var r,f,t,u;if(u=l(n,1,hu))for(r=0,f=u.length;r<f;r++)t=u[r],t.ch==="_"?(t=v[t.id])&&t.data!==i&&t.parent.removeViews(t._.key,i,!0):wt(t.id)}function gu(n,i,r){switch(r.change){case"set":for(var u=n.tgt,f=u.length;f--;)if(u[f].key===r.path)break;f===-1?r.path&&t.observable(u).insert({key:r.path,prop:r.value}):r.remove?t.observable(u).remove(f):t.observable(u[f]).setProperty("prop",r.value)}}function nf(n,i,r){var u,f=n.src;switch(r.change){case"set":r.path==="prop"?t.observable(f).setProperty(i.target.key,r.value):(t.observable(f).setProperty(r.oldValue,null),delete f[r.oldValue],t.observable(f).setProperty(r.value,i.target.prop));break;case"remove":u=r.items[0];t.observable(f).removeProperty(u.key);delete f[u.key];break;case"insert":u=r.items[0];u.key&&t.observable(f).setProperty(u.key,u.prop)}}function tf(n,t,i){return i.indexOf(".")<0&&t[n]}var bt="JsViews requires ",d,g,it,dr,kt,rt,gr,bi,ki,nt,a,ut,ft,e,p,v,f=n.document,r=t.views,u=r.sub,c=r.settings,y=u.extend,et=t.isFunction,nu=r.converters,w=r.tags,tt=t.observable,ot=tt.observe,o="data-jsv",di=u.propChng=u.propChng||"propertyChange",dt=u.arrChng=u.arrChng||"arrayChange",gi="change.jsv",gt="onBeforeChange",ni="onAfterChange",tu="onAfterCreate",b="checked",ti="checkbox",st="radio",ht="none",ct="true",nr='"><\/script>',tr='<script type="jsv',ii="script,["+o+"]",s="html",ri={value:"val",input:"val",html:s,text:"text"},ir={from:"value",to:"value"},ui=0,iu=t.cleanData,ru=c.delimiters,fi=u.syntaxErr,uu=/<(?!script)(\w+)(?:[^>]*(on\w+)\s*=)?[^>]*>/,fu=/['"\\]/g,rr=f.createDocumentFragment(),ei=f.querySelector,oi={ol:1,ul:1,table:1,tbody:1,thead:1,tfoot:1,tr:1,colgroup:1,dl:1,select:1,optgroup:1,svg:1,svg_ns:1},eu={tr:"table"},si={br:1,img:1,input:1,hr:1,area:1,base:1,col:1,link:1,meta:1,command:1,embed:1,keygen:1,param:1,source:1,track:1,wbr:1},ur={},h={},fr=1,ou=/^#(view\.?)?/,su=/(^|(\/>)|<\/(\w+)>|)(\s*)([#\/]\d+[_^])`(\s*)(<\w+(?=[\s\/>]))?|\s*(?:(<\w+(?=[\s\/>]))|<\/(\w+)>(\s*)|(\/>)\s*|(>))/g,er=/(#)()(\d+)(_)/g,hu=/(#)()(\d+)([_^])/g,cu=/(?:(#)|(\/))(\d+)(_)/g,lu=/(#)()(\d+)(\^)/g,au=/(?:(#)|(\/))(\d+)([_^])([-+@\d]+)?/g,or=n.getComputedStyle;if(!t)throw bt+"jQuery";if(!t.views)throw bt+"JsRender";if(!t.observable)throw bt+"jquery.observable";t.link||(ut={contents:function(n,r){n!==!!n&&(r=n,n=i);var f,u=t(this.nodes());return u[0]&&(f=r?u.filter(r):u,u=n&&r?f.add(u.find(r)):f),u},nodes:function(n,t,i){var r,u=this,f=u._elCnt,o=!t&&f,e=[];for(t=t||u._prv,i=i||u._nxt,r=o?t===u._nxt?u.parentElem.lastSibling:t:u._.inline===!1?t||u.linkCtx.elem.firstChild:t&&t.nextSibling;r&&(!i||r!==i);)(n||f||r.tagName!=="SCRIPT")&&e.push(r),r=r.nextSibling;return e},childTags:function(n,t){n!==!!n&&(t=n,n=i);var r=this,o=r.link?r:r.tagCtx.view,u=r._prv,f=r._elCnt,e=[];return u&&o.link(i,r.parentElem,f?u.previousSibling:u,r._nxt,i,{get:{tags:e,deep:n,name:t,id:f&&r._tgId}}),e},refresh:function(n){var u,f,t=this,e=t.linkCtx,o=t.tagCtx.view;return t.disposed&&nt("Removed tag"),n===i&&(n=r._tag(t,o,o.tmpl,wr(t),!0)),n+""===n&&(f=t._.inline?s:e.attr||lt(t.parentElem,!0),u=sr(n,e,f,t)),yt(t,t.tagCtx),u||t},update:function(n){var t=this.linkedElem;t&&k({target:t[0]},i,n)}},u.onStore.template=function(n,i){i.link=lr;i.unlink=br;n&&(t.link[n]=function(){return lr.apply(i,arguments)},t.unlink[n]=function(){return br.apply(i,arguments)})},u.onStore.tag=function(n,t){u._lnk(t)},u._lnk=function(n){return y(n,ut)},u.viewInfos=l,(c.delimiters=function(){var n=ru.apply(r,arguments);return dr=n[0],kt=n[1],rt=n[2],gr=n[3],bi=n[4],it=new RegExp("(?:^|\\s*)([\\w-]*)(\\"+bi+")?(\\"+kt+u.rTag+"\\"+rt+")","g"),this})(),y(u._lnk(u.View.prototype),{addViews:function(n,t,i){var u,o,r=this,f=t.length,e=r.views;if(!r._.useKey&&f&&(i=r.tmpl)&&(o=e.length+f,cr(r,n,i,e,t,r.ctx)!==!1))for(u=n+f;u<o;u++)tt(e[u]).setProperty("index",u);return r},removeViews:function(n,r,u){function o(n){var s,h,c,e,o,l,r=f[n];if(r&&r.link){if(s=r._.id,u||(l=r.nodes()),r.removeViews(i,i,!0),r.data=i,e=r._prv,o=r._nxt,c=r.parentElem,u||(r._elCnt&&wi(e,o,c,s,"_"),t(l).remove()),!r._elCnt)try{e.parentNode.removeChild(e);o.parentNode.removeChild(o)}catch(a){}hi(r);for(h in r._.bnds)wt(h);delete v[s]}}var e,l,s,h=this,c=!h._.useKey,f=h.views;if(c&&(s=f.length),n===i)if(c){for(e=s;e--;)o(e);h.views=[]}else{for(l in f)o(l);h.views={}}else if(r===i&&(c?r=1:(o(n),delete f[n])),c&&r){for(e=n+r;e-->n;)o(e);if(f.splice(n,r),s=f.length)while(n<s)tt(f[n]).setProperty("index",n++)}return this},refresh:function(n){var t=this,i=t.parent;return i&&(cr(t,t.index,t.tmpl,i.views,t.data,n,!0),hi(t)),t},link:pu}),v={0:p=new u.View(i,"top")},nu.merge=function(n){var t,i=this.linkCtx._val||"",r=this.tagCtx.props.toggle;return r&&(t=r.replace(/[\\^$.|?*+()[{]/g,"\\$&"),t="(\\s(?="+t+"$)|(\\s)|^)("+t+"(\\s|$))",i=i.replace(new RegExp(t),"$2"),n=i+(n?(i&&" ")+r:"")),n},w("on",{attr:ht,onAfterLink:function(n,r){for(var s,h,o=this,c=0,f=n.args,a=n.props.data,l=n.view,e=n.props.context;!et(s=f[c++]););if(h=f.slice(c),f=f.slice(0,c-1),e||(e=/^(.*)[\.^][\w$]+$/.exec(n.params.args.slice(-h.length-1)[0]),e=e&&u.tmplFn("{:"+e[1]+"}",l.tmpl,!0)(r.data,l)),s){o._evs&&o.onDispose();t(r.elem).on(o._evs=f[0]||"click",o._sel=f[1],a==i?null:a,o._hlr=function(n){return s.apply(e||r.data,[].concat(h,n,{change:n.type,view:l,linkCtx:r}))})}},onDispose:function(){t(this.parentElem).off(this._evs,this._sel,this._hlr)},flow:!0}),y(w["for"],{onArrayChange:function(n,t){var i,r=this,u=t.change;if(r.tagCtxs[1]&&(u==="insert"&&n.target.length===t.items.length||u==="remove"&&!n.target.length||u==="refresh"&&!t.oldItems.length!=!n.target.length))r.refresh();else for(i in r._.arrVws)i=r._.arrVws[i],i.data===n.target&&i._.onArrayChange.apply(i,arguments);n.done=!0},onAfterLink:function(){for(var u,o,i,f,e=this,r=e._ars||{},s=e.tagCtxs,c=s.length,h=e.selected||0,n=0;n<=h;n++)u=s[n],f=u.map?u.map.tgt:u.args.length?u.args[0]:u.view.data,(i=r[n])&&f!==i[0]&&(ot(i[0],i[1],!0),delete r[n]),!r[n]&&t.isArray(f)&&(ot(f,o=function(n,t){e.onArrayChange(n,t)}),r[n]=[f,o]);for(n=h+1;n<c;n++)(i=r[n])&&(ot(i[0],i[1],!0),delete r[n]);e._ars=r},onDispose:function(){var n,t=this;for(n in t._ars)ot(t._ars[n][0],t._ars[n][1],!0)}}),y(w["for"],ut),y(w["if"],ut),y(w.include,ut),w("props",{baseTag:w["for"],dataMap:r.map({getTgt:w.props.dataMap.getTgt,obsSrc:gu,obsTgt:nf,tgtFlt:tf})}),y(t,{view:r.view=g=function(n,r,u){r!==!!r&&(u=r,r=i);var e,o,h,c,w,s,b,a,y=0,k=f.body;if(n&&n!==k&&p._.useKey>1&&(n=""+n===n?t(n)[0]:n.jquery?n[0]:n,n))if(r){for(a=ei?n.querySelectorAll(ii):t(ii,n).get(),s=a.length,h=0;h<s;h++)for(b=a[h],o=l(b,i,er),c=0,w=o.length;c<w;c++)if(e=o[c],(e=v[e.id])&&(e=e&&u?e.get(!0,u):e,e))return e}else while(n){if(o=l(n,i,cu))for(s=o.length;s--;)if(e=o[s],e.open){if(y<1)return e=v[e.id],e&&u?e.get(u):e||p;y--}else y++;n=n.previousSibling||n.parentNode}return r?i:p},link:r.link=ai,unlink:r.unlink=pi,cleanData:function(n){n.length&&ui&&pt(n);iu.apply(t,arguments)}}),r.utility={validate:function(n){try{p.link(i,f.createElement("div"),i,i,n,i,i,1)}catch(t){return t.message}}},y(t.fn,{link:function(n,t,i,r,u,f,e){return ai(n,this,t,i,r,u,f,e)},unlink:function(n){return pi(n,this)},view:function(n){return g(this[0],n)}}),t.each([s,"replaceWith","empty","remove"],function(n,i){var r=t.fn[i];t.fn[i]=function(){var n;ui=1;try{n=r.apply(this,arguments)}finally{ui=0}return n}}),y(p,{tmpl:{links:{},tags:{}}}),p._.onRender=ci,c({wrapMap:e={option:[1,"<select multiple='multiple'>","<\/select>"],legend:[1,"<fieldset>","<\/fieldset>"],area:[1,"<map>","<\/map>"],param:[1,"<object>","<\/object>"],thead:[1,"<table>","<\/table>"],tr:[2,"<table><tbody>","<\/tbody><\/table>"],td:[3,"<table><tbody><tr>","<\/tr><\/tbody><\/table>"],col:[2,"<table><tbody><\/tbody><colgroup>","<\/colgroup><\/table>"],svg_ns:[1,"<svg>","<\/svg>"],div:jQuery.support.htmlSerialize?[0,"",""]:[1,"X<div>","<\/div>"]},linkAttr:a="data-link",merge:{input:{from:du,to:"value"},textarea:ir,select:ir,optgroup:{to:"label"}},jsrDbgMode:c.debugMode,debugMode:function(t){c.jsrDbgMode(t);t?n._jsv={views:v,bindings:h}:delete n._jsv},jsv:function(){c.debugMode(c._dbgMode);a=c.linkAttr;nt=r._err;ft=ii+",["+a+"]";ki=c.noDomLevel0;e.optgroup=e.option;e.tbody=e.tfoot=e.colgroup=e.caption=e.thead;e.th=e.td}}))})(this,this.jQuery);
/*
//# sourceMappingURL=jquery.views.min.js.map
*/