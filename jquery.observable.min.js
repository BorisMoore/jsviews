/*! JsObservable v1.0.0-alpha: http://github.com/BorisMoore/jsviews and http://jsviews.com/jsviews
informal pre V1.0 commit counter: 53 (Beta Candidate) */
(function(n,t,i){"use strict";function f(n){return r(n)?new k(n):new b(n)}function b(n){return this._data=n,this}function k(n){return this._data=n,this}function ct(n){return r(n)?[n]:n}function rt(n,t){n=r(n)?n:[n];for(var i,e=t,o=e,h=n.length,f=[],s=0;s<h;s++){if(i=n[s],u(i)){f=f.concat(rt(i.call(t,t),t));continue}else if(""+i!==i){t=o=i;o!==e&&f.push(e=o);continue}o!==e&&f.push(e=o);f.push(i)}return f}function ut(n,t){var r,i;for(r in n){i=!0;break}i||delete y[t]}function d(n,t){if(!(n.data&&n.data.off)){var v,y,p,f=t.oldValue,o=t.value,u=n.data,h=u.observeAll,c=!u.cb.noArray,a=u.paths;n.type===l?(u.cb.array||u.cb).call(u,n,t):(u.prop===t.path||u.prop==="*")&&(f=typeof f===s&&(a[0]||c&&r(f))&&f,o=typeof(o=t.value)===s&&(a[0]||c&&r(o))&&o,h?(v=h._path+"."+t.path,y=h.filter,p=[h.parents().slice()],f&&e(c,h.ns,[f],a,u.cb,!0,y,p,v),o&&e(c,h.ns,[o],a,u.cb,i,y,p,v)):(f&&e(c,[f],a,u.cb,!0),o&&e(c,[o],a,u.cb)),u.cb(n,t))}}function a(){function dt(i,r,u,f){var s,e,y=it(n),p=ct(n);if(i=at?i+"."+at:i,g||f)y&&t(p).off(i,d);else{if(o=y&&t._data(n))for(o=o&&o.events,o=o&&o[u?l:c],kt=o&&o.length;kt--;)if((nt=o[kt].data)&&nt.cb._cId===h._cId&&nt.ns===at){if(u)return;(r==="*"&&nt.prop!==r||nt.prop===v)&&t(n).off(i,d)}e=u?{}:{fullPath:a,paths:r?[r]:[],prop:v};e.ns=at;e.cb=h;lt&&(e.observeAll={_path:lt,path:function(){return s=ii.length,lt.replace(/[[.]/g,function(n){return s--,n==="["?"["+t.inArray(ii[s-1],ii[s]):"."})},parents:function(){return ii},filter:ei,ns:at});t(p).on(i,null,e,d);ni&&(ni[t.data(n,"obId")||t.data(n,"obId",ht++)]=n)}}function vi(n,t){n._ob=yt(n,ft);var i=ft;return function(u,f){var o=n._ob,c=t.length;typeof o===s&&(gt(o,!0),(c||vt&&r(o))&&e(vt,[o],t,h,yt,!0));o=n._ob=yt(n,i);typeof o===s&&(gt(o),(c||vt&&r(o))&&e(vt,[o],t,h,yt,[i]));h(u,f)}}function gt(t,u,e,o){if(vt){var s=n,c=lt;n=t;o&&(n=t[o],lt+="."+o,ei&&(n=f._fltr(o,t,lt,ei)));n&&(e||r(n))&&dt(l+".observe"+(h?".obs"+(bt=h._cId=h._cId||w++):""),i,!0,u);n=s;lt=c}}var wt,ui,oi,et,v,a,fi,g,h,bt,kt,nt,o,yt,si,ni,ti,hi,ii,lt,ei,at,ci,li,vt=this!=!1,ai=1,ri=st,b=Array.apply(0,arguments),k=b.pop(),ft=b.shift(),pt=ft,n=pt,tt=b.length;for(ft+""===ft&&vt&&(at=ft,ft=n=pt=b.shift(),tt--),u(k)?h=k:(k+""===k&&(lt=k,ii=b.pop(),ei=b.pop(),k=b.pop(),tt=tt-3),k===!0?g=k:k&&(ft=k,ai=0),k=b[tt-1],(tt&&k===i||u(k))&&(h=b.pop(),tt--)),tt&&u(b[tt-1])&&(yt=h,h=b.pop(),tt--),ri+=g?h?".obs"+h._cId:"":".obs"+(bt=h._cId=h._cId||w++),g||(ni=y[bt]=y[bt]||{}),ci=at&&at.match(ot)||[""],li=ci.length;li--;)for(at=ci[li],r(pt)?gt(pt,g,!0):g&&tt===0&&pt&&dt(ri,""),ti=0,wt=0;wt<tt;wt++)if(a=b[wt],a!==""){if(n=pt,""+a===a){if(et=a.split("^"),et[1]&&(ti=et[0].split(".").length,a=et.join("."),ti=a.split(".").length-ti),yt&&(si=yt(a,pt))){tt+=si.length-1;p.apply(b,[wt--,1].concat(si));continue}et=a.split(".")}else ai&&!u(a)&&(a._jsvOb&&(a._cb=hi=vi(a,b.slice(wt+1)),hi.noArray=vt===!1,hi._cId=h._cId,e(vt,[ft],b.slice(0,wt),a._cb,yt),a=a._ob),n=a),pt=a,et=[pt];while(n&&(v=et.shift())!==i)if(typeof n===s){if(""+v===v){if(v==="")continue;if(et.length<ti+1&&!n.nodeType){if(!g&&(o=it(n)&&t._data(n))){for(o=o.events,o=o&&o[c],kt=o&&o.length,oi=0;kt--;)nt=o[kt].data,nt&&nt.cb===h&&nt.ns===at&&(nt.prop===v||nt.prop==="*")&&((ui=et.join("."))&&nt.paths.push(ui),oi++);if(oi){n=n[v];continue}}if(v==="*"){!g&&o&&o.length&&dt(ri,"",!1,!0);u(n)?(fi=n.depends)&&e(vt,[fi],h,g||ft):dt(ri,"");for(ui in n)gt(n,g,i,ui);break}else v&&dt(ri+"."+v,et.join("."))}lt&&(lt+="."+v);v=n[v]}if(u(v)){(fi=v.depends)&&e(vt,[n],rt(fi,n),h,yt,g||[ft]);break}n=v}gt(n,g)}return bt&&ut(ni,bt),{cbId:bt,bnd:ni,leaf:n}}function lt(){return[].push.call(arguments,!0),a.apply(this,arguments)}function e(){var n=[].concat.apply([],arguments);return a.apply(n.shift(),n)}function ft(n,t,i){return i.indexOf(".")<0&&i.indexOf("[")<0&&t[n]}function at(n,r,u,f,e){return f=f||ft,e=e||ft,{getTgt:n,obsSrc:r,obsTgt:u,map:function(i){var o=this,h,c;return o.src!==i&&(o.src&&o.unmap(),typeof i===s&&(c=n.apply(o,arguments),t.observable&&(t.observable(i).observeAll(o.obs=function(n,t){!h&&r&&(h=!0,r.call(o,i,c,n,t),h=!1)},f),t.observable(c).observeAll(o.obt=function(n,t){!h&&u&&(h=!0,u.call(o,i,c,n,t),h=!1)},e)),o.src=i,o.tgt=c)),o},unmap:function(){if(t.observable){var n=this;n.src&&(t.observable(n.src).unobserveAll(n.obs,f),t.observable(n.tgt).unobserveAll(n.obt,e),n.src=n.tgt=i)}}}}function g(n,t,i,r){n+""!==n&&(i=t,t=n,n="");v(n,this._data,t,i,[],"root",r)}function et(n,t,i){g.call(this,n,t,i,!0)}function v(n,t,u,e,o,h,c){function p(t,i){for(y=t.length,l=h+"[]";y--;)(k=f._fltr(y,t,l,e))&&v(n,k,u,e||"",o.slice(),l,i)}function d(t,i){h=t.data.observeAll._path;var r=o;o[0]!==t.target&&(o=o.slice(),o.unshift(t.target));switch(i.change){case"insert":p(i.items);break;case"remove":p(i.items,!0);break;case"refresh":p(i.oldItems,!0);p(t.target);break;case"set":l=h+"."+i.path;v(n,i.oldValue,u,0,o.slice(),l,!0);v(n,i.value,u,0,o.slice(),l)}u.apply(this,arguments);o=r}var y,b,l,k;if(typeof t===s)if(b=r(t)?"":"*",o.unshift(t),u?(b||e!==0)&&(d._cId=u._cId=u._cId||w++,a(n,t,b,d,c,e,o.slice(),h)):a(n,t,b,i,c,e,o.slice(),h),b)for(y in t)y.charAt(0)!=="_"&&y!==tt&&(l=h+"."+y,(k=f._fltr(y,t,l,e))&&v(n,k,u,e||0,o.slice(),l,c));else p(t,c)}if(!t)throw"jsViews/jsObservable require jQuery";if(!t.observable){var nt=t.event.special,o=t.views?t.views.sub:f.sub={},p=[].splice,r=t.isArray,tt=t.expando,s="object",h=parseInt,ot=/\S+/g,c=o.propChng=o.propChng||"propertyChange",l=o.arrChng=o.arrChng||"arrayChange",y=o._cbBnds=o._cbBnds||{},st=c+".observe",u=o.isFn,ht=1,w=1,it=t.hasData;o.getDeps=function(){var n=arguments;return function(){for(var i,t,r=[],f=n.length;f--;)i=n[f--],t=n[f],t&&(r=r.concat(u(t)?t(i,i):t));return r}};o.DataMap=at;t.observable=f;f._fltr=function(n,t,i,r){var f=r&&u(r)?r(n,t,i):t[n];return f&&(f=u(f)?f.set&&f.call(t):f),typeof f===s&&f};f.Object=b;f.Array=k;t.observe=f.observe=a;t.unobserve=f.unobserve=lt;f._apply=e;b.prototype={_data:null,observeAll:g,unobserveAll:et,data:function(){return this._data},setProperty:function(n,t,u){var f,h,s,e=this,o=e._data;if(n=n||"",o)if(r(n))for(f=n.length;f--;)h=n[f],e.setProperty(h.name,h.value,u===i||u);else if(""+n!==n)for(f in n)e.setProperty(f,n[f],t);else if(n!==tt){for(s=n.split(".");o&&s.length>1;)o=o[s.shift()];e._setProperty(o,s.join("."),t,u)}return e},_setProperty:function(n,t,i,r){var e,o,f=t?n[t]:n;u(f)&&f.set&&(o=f,e=f.set===!0?f:f.set,f=f.call(n));(f!==i||r&&f!=i)&&(!(f instanceof Date)||f>i||f<i)&&(e?(e.call(n,i),i=o.call(n)):t&&(n[t]=i),this._trigger(n,{change:"set",path:t,value:i,oldValue:f}))},_trigger:function(n,i){t(n).triggerHandler(c,i)}};k.prototype={_data:null,observeAll:g,unobserveAll:et,data:function(){return this._data},insert:function(n,t){var i=this._data;return arguments.length===1&&(t=n,n=i.length),n=h(n),n>-1&&n<=i.length&&(t=r(t)?t:[t],t.length&&this._insert(n,t)),this},_insert:function(n,t){var i=this._data,r=i.length;p.apply(i,[n,0].concat(t));this._trigger({change:"insert",index:n,items:t},r)},remove:function(n,t){var r,u=this._data;return n===i&&(n=u.length-1),n=h(n),t=t?h(t):t===0?0:1,t>-1&&n>-1&&(r=u.slice(n,n+t),t=r.length,t&&this._remove(n,t,r)),this},_remove:function(n,t,i){var r=this._data,u=r.length;r.splice(n,t);this._trigger({change:"remove",index:n,items:i},u)},move:function(n,t,i){if(i=i?h(i):i===0?0:1,n=h(n),t=h(t),i>0&&n>-1&&t>-1&&n!==t){var r=this._data.slice(n,n+i);i=r.length;i&&this._move(n,t,i,r)}return this},_move:function(n,t,i,r){var u=this._data,f=u.length;u.splice(n,i);u.splice.apply(u,[t,0].concat(r));this._trigger({change:"move",oldIndex:n,index:t,items:r},f)},refresh:function(n){var t=this._data.slice();return this._refresh(t,n),this},_refresh:function(n,t){var i=this._data,r=i.length;p.apply(i,[0,i.length].concat(t));this._trigger({change:"refresh",oldItems:n},r)},_trigger:function(n,i){var r=this._data,u=r.length,f=t([r]);f.triggerHandler(l,n);u!==i&&f.triggerHandler(c,{change:"set",path:"length",value:u,oldValue:i})}};nt[c]=nt[l]={remove:function(n){var r,u,f,e,o,i=n.data;if(i&&(i.off=1,i=i.cb)&&(r=y[i._cId])){for(f=t._data(this).events[n.type],e=f.length;e--&&!u;)u=(o=f[e].data)&&o.cb===i;u||(delete r[t.data(this,"obId")],ut(r,i._cId))}}}}})(this,this.jQuery);
/*
//# sourceMappingURL=jquery.observable.min.js.map
*/