/*! JsObservable v1.0.0-alpha: http://github.com/BorisMoore/jsviews and http://jsviews.com/jsviews
informal pre V1.0 commit counter: 54 (Beta Candidate) */
(function(n,t,i){"use strict";function f(n){return r(n)?new k(n):new b(n)}function b(n){return this._data=n,this}function k(n){return this._data=n,this}function lt(n){return r(n)?[n]:n}function ut(n,t){n=r(n)?n:[n];for(var i,e=t,o=e,h=n.length,f=[],s=0;s<h;s++){if(i=n[s],u(i)){f=f.concat(ut(i.call(t,t),t));continue}else if(""+i!==i){t=o=i;o!==e&&f.push(e=o);continue}o!==e&&f.push(e=o);f.push(i)}return f}function ft(n,t){var r,i;for(r in n){i=!0;break}i||delete y[t]}function d(n,t){if(!(n.data&&n.data.off)){var v,y,p,f=t.oldValue,o=t.value,u=n.data,h=u.observeAll,c=!u.cb.noArray,a=u.paths;n.type===l?(u.cb.array||u.cb).call(u,n,t):(u.prop===t.path||u.prop==="*")&&(f=typeof f===s&&(a[0]||c&&r(f))&&f,o=typeof(o=t.value)===s&&(a[0]||c&&r(o))&&o,h?(v=h._path+"."+t.path,y=h.filter,p=[h.parents().slice()],f&&e(c,h.ns,[f],a,u.cb,!0,y,p,v),o&&e(c,h.ns,[o],a,u.cb,i,y,p,v)):(f&&e(c,[f],a,u.cb,!0),o&&e(c,[o],a,u.cb)),u.cb(n,t))}}function a(){function dt(i,r,u,f){var s,e,y=it(n),p=lt(n);if(i=at?i+"."+at:i,g||f)y&&t(p).off(i,d);else{if(o=y&&t._data(n))for(o=o&&o.events,o=o&&o[u?l:c],kt=o&&o.length;kt--;)if((nt=o[kt].data)&&nt.cb._cId===h._cId&&nt.ns===at){if(u)return;(r==="*"&&nt.prop!==r||nt.prop===a)&&t(n).off(i,d)}e=u?{}:{fullPath:v,paths:r?[r]:[],prop:a};e.ns=at;e.cb=h;ot&&(e.observeAll={_path:ot,path:function(){return s=ri.length,ot.replace(/[[.]/g,function(n){return s--,n==="["?"["+t.inArray(ri[s-1],ri[s]):"."})},parents:function(){return ri},filter:oi,ns:at});t(p).on(i,null,e,d);ni&&(ni[t.data(n,"obId")||t.data(n,"obId",ct++)]=n)}}function vi(n,t){n._ob=yt(n,rt);var i=rt;return function(u,f){var o=n._ob,c=t.length;typeof o===s&&(gt(o,!0),(c||vt&&r(o))&&e(vt,[o],t,h,yt,!0));o=n._ob=yt(n,i);typeof o===s&&(gt(o),(c||vt&&r(o))&&e(vt,[o],t,h,yt,[i]));h(u,f)}}function gt(t,u,e,o){if(vt){var s=n,c=ot;n=t;o&&(n=t[o],ot+="."+o,oi&&(n=f._fltr(o,t,ot,oi)));n&&(e||r(n))&&dt(l+".observe"+(h?".obs"+(bt=h._cId=h._cId||w++):""),i,!0,u);n=s;ot=c}}var wt,fi,si,et,a,v,ei,g,h,bt,kt,nt,o,yt,hi,ni,ti,ii,ri,ot,oi,at,ci,li,vt=this!=!1,ai=1,ui=ht,b=Array.apply(0,arguments),k=b.pop(),rt=b.shift(),pt=rt,n=pt,tt=b.length;for(rt+""===rt&&vt&&(at=rt,rt=n=pt=b.shift(),tt--),u(k)?h=k:(k+""===k&&(ot=k,ri=b.pop(),oi=b.pop(),k=b.pop(),tt=tt-3),k===!0?g=k:k&&(rt=k,ai=0),k=b[tt-1],(tt&&k===i||u(k))&&(h=b.pop(),tt--)),tt&&u(b[tt-1])&&(yt=h,h=b.pop(),tt--),ui+=g?h?".obs"+h._cId:"":".obs"+(bt=h._cId=h._cId||w++),g||(ni=y[bt]=y[bt]||{}),ci=at&&at.match(st)||[""],li=ci.length;li--;)for(at=ci[li],r(pt)?gt(pt,g,!0):g&&tt===0&&pt&&dt(ui,""),ti=0,wt=0;wt<tt;wt++)if(v=b[wt],v!==""){if(n=pt,""+v===v){if(et=v.split("^"),et[1]&&(ti=et[0].split(".").length,v=et.join("."),ti=v.split(".").length-ti),yt&&(hi=yt(v,pt))){tt+=hi.length-1;p.apply(b,[wt--,1].concat(hi));continue}et=v.split(".")}else ai&&!u(v)&&(v._jsvOb&&(ii=vi(v,b.slice(wt+1)),ii.noArray=!vt,ii._cId=h._cId,e(vt,[rt],b.slice(0,wt),ii,yt),ii=i,v=v._ob),n=v),pt=v,et=[pt];while(n&&(a=et.shift())!==i)if(typeof n===s){if(""+a===a){if(a==="")continue;if(et.length<ti+1&&!n.nodeType){if(!g&&(o=it(n)&&t._data(n))){for(o=o.events,o=o&&o[c],kt=o&&o.length,si=0;kt--;)nt=o[kt].data,nt&&nt.cb===h&&nt.ns===at&&(nt.prop===a||nt.prop==="*")&&((fi=et.join("."))&&nt.paths.push(fi),si++);if(si){n=n[a];continue}}if(a==="*"){!g&&o&&o.length&&dt(ui,"",!1,!0);u(n)?(ei=n.depends)&&e(vt,[ei],h,g||rt):dt(ui,"");for(fi in n)gt(n,g,i,fi);break}else a&&dt(ui+"."+a,et.join("."))}ot&&(ot+="."+a);a=n[a]}if(u(a)){(ei=a.depends)&&e(vt,[n],ut(ei,n),h,yt,g||[rt]);break}n=a}gt(n,g)}return bt&&ft(ni,bt),{cbId:bt,bnd:ni}}function at(){return[].push.call(arguments,!0),a.apply(this,arguments)}function e(){var n=[].concat.apply([],arguments);return a.apply(n.shift(),n)}function et(n,t,i){return i.indexOf(".")<0&&i.indexOf("[")<0&&t[n]}function vt(n,r,u,f,e){return f=f||et,e=e||et,{getTgt:n,obsSrc:r,obsTgt:u,map:function(i){var o=this,h,c;return o.src!==i&&(o.src&&o.unmap(),typeof i===s&&(c=n.apply(o,arguments),t.observable&&(t.observable(i).observeAll(o.obs=function(n,t){!h&&r&&(h=!0,r.call(o,i,c,n,t),h=!1)},f),t.observable(c).observeAll(o.obt=function(n,t){!h&&u&&(h=!0,u.call(o,i,c,n,t),h=!1)},e)),o.src=i,o.tgt=c)),o},unmap:function(){if(t.observable){var n=this;n.src&&(t.observable(n.src).unobserveAll(n.obs,f),t.observable(n.tgt).unobserveAll(n.obt,e),n.src=n.tgt=i)}}}}function g(n,t,i,r){n+""!==n&&(i=t,t=n,n="");v(n,this._data,t,i,[],"root",r)}function ot(n,t,i){g.call(this,n,t,i,!0)}function v(n,t,u,e,o,h,c){function p(t,i){for(y=t.length,l=h+"[]";y--;)(k=f._fltr(y,t,l,e))&&v(n,k,u,e||"",o.slice(),l,i)}function d(t,i){h=t.data.observeAll._path;var r=o;o[0]!==t.target&&(o=o.slice(),o.unshift(t.target));switch(i.change){case"insert":p(i.items);break;case"remove":p(i.items,!0);break;case"refresh":p(i.oldItems,!0);p(t.target);break;case"set":l=h+"."+i.path;v(n,i.oldValue,u,0,o.slice(),l,!0);v(n,i.value,u,0,o.slice(),l)}u.apply(this,arguments);o=r}var y,b,l,k;if(typeof t===s)if(b=r(t)?"":"*",o.unshift(t),u?(b||e!==0)&&(d._cId=u._cId=u._cId||w++,a(n,t,b,d,c,e,o.slice(),h)):a(n,t,b,i,c,e,o.slice(),h),b)for(y in t)y.charAt(0)!=="_"&&y!==tt&&(l=h+"."+y,(k=f._fltr(y,t,l,e))&&v(n,k,u,e||0,o.slice(),l,c));else p(t,c)}if(!t)throw"jsViews/jsObservable require jQuery";if(!t.observable){var nt=t.event.special,o=t.views?t.views.sub:f.sub={},p=[].splice,r=t.isArray,tt=t.expando,s="object",h=parseInt,st=/\S+/g,c=o.propChng=o.propChng||"propertyChange",l=o.arrChng=o.arrChng||"arrayChange",y=o._cbBnds=o._cbBnds||{},ht=c+".observe",u=t.isFunction,ct=1,w=1,it=t.hasData,rt={};o.getDeps=function(){var n=arguments;return function(){for(var i,t,r=[],f=n.length;f--;)i=n[f--],t=n[f],t&&(r=r.concat(u(t)?t(i,i):t));return r}};o.DataMap=vt;t.observable=f;f._fltr=function(n,t,i,r){var f=r&&u(r)?r(n,t,i):t[n];return f&&(f=u(f)?f.set&&f.call(t):f),typeof f===s&&f};f.Object=b;f.Array=k;t.observe=f.observe=a;t.unobserve=f.unobserve=at;f._apply=e;b.prototype={_data:null,observeAll:g,unobserveAll:ot,data:function(){return this._data},setProperty:function(n,t,u){var f,h,s,o=this,e=o._data;if(n=n||"",e)if(r(n))for(f=n.length;f--;)h=n[f],o.setProperty(h.name,h.value,u===i||u);else if(""+n!==n)for(f in n)o.setProperty(f,n[f],t);else if(n!==tt){for(s=n.split(".");e&&s.length>1;)e=e[s.shift()];e&&o._setProperty(e,s[0],t,u)}return o},removeProperty:function(n){return this.setProperty(n,rt),this},_setProperty:function(n,t,r,f){var o,s,h,e=t?n[t]:n;u(e)&&e.set&&(s=e,o=e.set===!0?e:e.set,e=e.call(n));(e!==r||f&&e!=r)&&(!(e instanceof Date)||e>r||e<r)&&(o?(o.call(n,r),r=s.call(n)):(h=r===rt)?(delete n[t],r=i):t&&(n[t]=r),this._trigger(n,{change:"set",path:t,value:r,oldValue:e,remove:h}))},_trigger:function(n,i){t(n).triggerHandler(c,i)}};k.prototype={_data:null,observeAll:g,unobserveAll:ot,data:function(){return this._data},insert:function(n,t){var i=this._data;return arguments.length===1&&(t=n,n=i.length),n=h(n),n>-1&&n<=i.length&&(t=r(t)?t:[t],t.length&&this._insert(n,t)),this},_insert:function(n,t){var i=this._data,r=i.length;p.apply(i,[n,0].concat(t));this._trigger({change:"insert",index:n,items:t},r)},remove:function(n,t){var r,u=this._data;return n===i&&(n=u.length-1),n=h(n),t=t?h(t):t===0?0:1,t>-1&&n>-1&&(r=u.slice(n,n+t),t=r.length,t&&this._remove(n,t,r)),this},_remove:function(n,t,i){var r=this._data,u=r.length;r.splice(n,t);this._trigger({change:"remove",index:n,items:i},u)},move:function(n,t,i){if(i=i?h(i):i===0?0:1,n=h(n),t=h(t),i>0&&n>-1&&t>-1&&n!==t){var r=this._data.slice(n,n+i);i=r.length;i&&this._move(n,t,i,r)}return this},_move:function(n,t,i,r){var u=this._data,f=u.length;u.splice(n,i);u.splice.apply(u,[t,0].concat(r));this._trigger({change:"move",oldIndex:n,index:t,items:r},f)},refresh:function(n){var t=this._data.slice();return this._refresh(t,n),this},_refresh:function(n,t){var i=this._data,r=i.length;p.apply(i,[0,i.length].concat(t));this._trigger({change:"refresh",oldItems:n},r)},_trigger:function(n,i){var r=this._data,u=r.length,f=t([r]);f.triggerHandler(l,n);u!==i&&f.triggerHandler(c,{change:"set",path:"length",value:u,oldValue:i})}};nt[c]=nt[l]={remove:function(n){var r,u,f,e,o,i=n.data;if(i&&(i.off=1,i=i.cb)&&(r=y[i._cId])){for(f=t._data(this).events[n.type],e=f.length;e--&&!u;)u=(o=f[e].data)&&o.cb===i;u||(delete r[t.data(this,"obId")],ft(r,i._cId))}}}}})(this,this.jQuery);
/*
//# sourceMappingURL=jquery.observable.min.js.map
*/