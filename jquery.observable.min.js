/*! JsObservable v0.9.87 (Beta): http://jsviews.com/#jsobservable */
!function(t,e){var n=e.jQuery;"object"==typeof exports?module.exports=n?t(e,n):function(n){return t(e,n)}:"function"==typeof define&&define.amd?define(["jquery"],function(n){return t(e,n)}):t(e,!1)}(function(t,e){"use strict";var n=e===!1;if(e=e||t.jQuery,!e||!e.fn)throw"JsObservable requires jQuery";var r,i,o="v0.9.87",s="_ocp",a=e.views=e.views||n&&t.jsrender&&jsrender.views||{jsviews:o,sub:{settings:{}},settings:{advanced:function(t){return l=f.advanced=f.advanced||{_jsv:!0},t?("_jsv"in t&&(l._jsv=t._jsv),c.advSet(),a.settings):l}}},c=a.sub,f=c.settings,l=f.advanced,u=e.isFunction,p=e.expando,d=e.isArray,h="object";if(!e.observe){var v=e.event.special,_=[].slice,g=[].splice,b=[].concat,y=parseInt,m=/\S+/g,I=c.propChng=c.propChng||"propertyChange",j=c.arrChng=c.arrChng||"arrayChange",w={},A=I+".observe",x=1,F=1,P=1,S=e.hasData,k=e.data,C={},O=function(t){return t._cId=t._cId||".obs"+F++},T=function(t,e){return this._data=e,this._ns=t,this},V=function(t,e){return this._data=e,this._ns=t,this},D=function(t){return d(t)?[t]:t},H=function(t,e,n){t=t?d(t)?t:[t]:[];var r,i,o,s,a=o=e,c=t&&t.length,f=[];for(r=0;r<c;r++)i=t[r],u(i)?(s=e._ocp?e.view.data:e,f=f.concat(H(i.call(s,s,n),e,n))):""+i===i?(a!==o&&f.push(o=a),f.push(i)):(e=a=i,a!==o&&f.push(o=a));return f.length&&(f.unshift({_ar:1}),f.push({_ar:-1})),f},Q=function(t,e){for(var n in t)return;delete w[e]},q=function(t,e){function n(t){return typeof t===h&&(p[0]||u&&d(t))}if(!t.data||!t.data.off){var r,i,o,s=e.oldValue,a=e.value,c=t.data,f=c.observeAll,l=c.cb,u=c.arOk,p=c.paths,v=c.ns;t.type===j?(l.array||l).call(c,t,e):c.prop!==e.path&&"*"!==c.prop||(f?(r=f._path+"."+e.path,i=f.filter,o=[t.target].concat(f.parents()),n(s)&&M(void 0,v,[s],p,l,!0,i,[o],r),n(a)&&M(void 0,v,[a],p,l,void 0,i,[o],r)):(n(s)&&M(void 0,v,[s],p,l,!0),n(a)&&M(void 0,v,[a],p,l)),c.cb(t,e))}},M=function(){var t=b.apply([],arguments);return r.apply(t.shift(),t)},B=function(t,e,n){z(this._ns,this._data,t,e,[],"root",n)},J=function(t,e){B.call(this,t,e,!0)},z=function(t,e,n,o,s,a,c,f){function l(t,e){for(_=t.length,b=a+"[]";_--;)u(t,_,e,1)}function u(e,r,s,a){var c,l;r!==p&&(c=i._fltr(b,e[r],y,o))&&(l=y.slice(),a&&m&&l[0]!==m&&l.unshift(m),z(t,c,n,o||(a?void 0:0),l,b,s,f))}function v(t,e){switch(a=t.data.observeAll._path,m=t.target,e.change){case"insert":l(e.items);break;case"remove":l(e.items,!0);break;case"set":b=a+"."+e.path,u(e,"oldValue",!0),u(e,"value")}m=void 0,n.apply(this,arguments)}v._wrp=1;var _,g,b,y,m,I,j=!f||f.un||!c;if(e&&typeof e===h){if(y=[e].concat(s),g=d(e)?"":"*",f&&j&&S(e)&&f[I=k(e).obId])return void f[I]++;if(f||(f={un:c}),n){if(g||0!==o)if(v._cId=O(n),j)r(t,e,g,v,c,o,y,a),I=k(e).obId,f[I]=(f[I]||0)+1;else{if(--f[k(e).obId])return;r(t,e,g,v,c,o,y,a)}}else f&&(f[k(e).obId]=1),r(t,e,g,void 0,c,o,y,a);if(g)for(_ in e)b=a+"."+_,u(e,_,c);else l(e,c)}},E=function(t){return t.indexOf(".")<0&&t.indexOf("[")<0},G=function(){return[].push.call(arguments,!0),r.apply(void 0,arguments)};r=function(){function t(){function o(t,i,o,s){var a,c,f=S(ft),l=D(ft),u=$,p=tt;if(t=n?t+"."+n:t,!J&&(s||o))for(N=f&&e._data(ft),N=N&&N.events,N=N&&N[o?j:I],K=N&&N.length;K--;)if(L=N[K]&&N[K].data,L&&(s&&L.ns!==n||!s&&L.ns===n&&L.cb&&L.cb._cId===z._cId&&(!z._wrp||L.cb._wrp)))return;J||s?e(l).off(t,q):(c=o?{}:{fullPath:M,paths:i?[i]:[],prop:V,arOk:r},c.ns=n,c.cb=z,tt&&(c.observeAll={_path:p,path:function(){return a=u.length,p.replace(/[[.]/g,function(t){return a--,"["===t?"["+e.inArray(u[a-1],u[a]):"."})},parents:function(){return u},filter:et}),e(l).on(t,null,c,q),X&&(X[k(ft).obId||k(ft,"obId",x++)]=ft))}function l(e){var n=ct;return e.ob=R(e,n),e.cb=function(i,o){var s=e.ob,a=e.sb,c=R(e,n);c!==s&&(typeof s===h&&(v(s,!0),(a||r&&d(s))&&t([s],a,z,R,!0)),e.ob=c,typeof c===h&&(v(c),(a||r&&d(c))&&t([c],a,z,R))),z(i,o)}}function v(t,e,n,s){if(r){var a=ft,c=tt;ft=t,s&&(ft=t[s],tt+="."+s),et&&ft&&(ft=i._fltr(tt,ft,s?[t].concat($):$,et)),ft&&(n||d(ft))&&o(j+".observe"+(z?O(z):""),void 0,!0,e),ft=a,tt=c}}var y,F,C,T,V,M,B,J,z,E,G,K,L,N,R,U,W,X,Y,Z,$,tt,et,nt,rt,it,ot=A,st=1!=this?b.apply([],arguments):_.call(arguments),at=st.pop()||!1,ct=st.shift(),ft=ct,lt=st.length;if(f.unshift(ct),at+""===at&&(tt=at,$=st.pop(),et=st.pop(),at=!!st.pop(),lt-=3),at===!!at&&(J=at,at=st[lt-1],at=!lt||at+""===at||at&&!u(at)?void 0:(lt--,st.pop()),J&&!lt&&u(ct)&&(at=ct,ct=void 0)),z=at,lt&&u(st[lt-1])&&(U=R=z,z=st.pop(),lt--),J&&z&&!z._cId)return void f.shift();for(ot+=z?(G=z._inId||"",J?z._cId+G:(E=O(z))+G):"",E&&!J&&(X=w[E]=w[E]||{}),nt=n&&n.match(m)||[""],rt=nt.length;rt--;){if(n=nt[rt],ct&&!st[0]&&(d(ct)&&v(ct,J,!0),J&&o(ot,"")),J&&!lt&&!ct)for(F in w){F=w[F];for(L in F)ft=F[L],d(ft)?v(ft,J,J):o(ot,"")}for(Y=0,y=0;y<lt;y++)if(M=st[y],""!==M&&M!==ct)if(M&&M._ar)r+=M._ar;else if(ft=ct,""+M===M?(T=M.split("^"),T[1]&&(Y=T[0].split(".").length,M=T.join("."),Y=M.split(".").length-Y),R&&(W=R(M,ct,Y)),R=U,T=M.split(".")):M&&M._cxp?(it=M.shift(),s in it?(ct=it,R=0):(R=c._gccb(it),ct=it.data),W=M,W.push(a)):(u(M)||M&&M._cpfn&&(Z=J?M.cb:l(M),Z._cId=z._cId,Z._inId=Z._inId||".obIn"+P++,(M.bnd||M.prm&&M.prm.length||!M.sb)&&t([ft],M.path,[M.root||ct],M.prm,Z,R,J),M.sb&&(M.sb.prm&&(M.sb.root=ct),t([M.ob],M.sb,z,R,J)),M=a,ft=void 0),T=[ct=M]),W)lt+=W.length-1,g.apply(st,[y--,1].concat(W)),W=void 0;else for(;ft&&void 0!==(V=T.shift());)if(typeof ft===h){if(""+V===V){if(""===V)continue;if(T.length<Y+1&&!ft.nodeType){if(!J&&(N=S(ft)&&e._data(ft))){for(N=N.events,N=N&&N[I],K=N&&N.length,C=0;K--;)L=N[K].data,!L||L.ns!==n||L.cb._cId!==z._cId||L.cb._inId!==z._inId||L.prop!==V&&"*"!==L.prop&&"**"!==L.prop||((F=T.join("."))&&L.paths.push(F),C++);if(C){ft=ft[V];continue}}if("*"===V||"**"===V){if(!J&&N&&N.length&&o(ot,"",!1,!0),"*"===V){o(ot,"");for(F in ft)F!==p&&v(ft,J,void 0,F)}else e.observable(n,ft)[(J?"un":"")+"observeAll"](z);break}V&&o(ot+".p_"+V,T.join("^"))}tt&&(tt+="."+V),V=ft[V],T[0]||v(V,J)}if(u(V)){(B=V.depends)&&t([ft._ocp?ft.view.data:ft],H(B,ft,z),z,R,J);break}ft=V}}return E&&Q(X,E),f.shift(),{cbId:E,bnd:X,s:w}}var n,r=1==this?0:1,o=_.call(arguments),a=o[0],f=[a];return a+""===a&&r&&(n=a,o.shift(),a=o[0]),t.apply(1,o)},i=function(t,e){return 1===arguments.length&&(e=t,t=""),d(e)?new V(t,e):new T(t,e)},e.observable=i,i._fltr=function(t,e,n,r){if(!r||!u(r)||r(t,e,n))return e=u(e)?e.set&&e.call(n[0]):e,typeof e===h&&e},i.Object=T,i.Array=V,e.observe=i.observe=r,e.unobserve=i.unobserve=G,i._apply=M,T.prototype={_data:null,observeAll:B,unobserveAll:J,data:function(){return this._data},setProperty:function(t,e,n){t=t||"";var r,i,o,s=t+""!==t&&!t._is,a=this,c=a._data;if(c)if(s)if(n=e,d(t))for(r=t.length;r--;)i=t[r],a.setProperty(i.name,i.value,void 0===n||n);else for(r in t)a.setProperty(r,t[r],n);else if(t!==p){if(t._is)o=[t];else for(o=t.split(/[.^]/);c&&o.length>1;)c=c[o.shift()];c&&a._setProperty(c,o[0],e,n)}return a},removeProperty:function(t){return this.setProperty(t,C),this},_setProperty:function(t,e,n,r){var i,o,s,a=e?t[e]:t;u(a)&&a.set&&(t=t._vw||t,o=a,i=o.set===!0?o:o.set,a=o.call(t)),(a!==n||r&&a!=n)&&(!(a instanceof Date&&n instanceof Date)||a>n||a<n)&&(i?(i.call(t,n),n=o.call(t)):(s=n===C)?void 0!==a?(delete t[e],n=void 0):e=void 0:e&&(t[e]=n),e&&this._trigger(t,{change:"set",path:e,value:n,oldValue:a,remove:s}))},_trigger:function(t,n){e(t).triggerHandler(I+(this._ns?"."+/^\S+/.exec(this._ns)[0]:""),n)}},V.prototype={_data:null,observeAll:B,unobserveAll:J,data:function(){return this._data},insert:function(t,e){var n=this._data;return 1===arguments.length&&(e=t,t=n.length),t=y(t),t>-1&&(e=d(e)?e:[e],e.length&&this._insert(t,e)),this},_insert:function(t,e){var n=this._data,r=n.length;t>r&&(t=r),g.apply(n,[t,0].concat(e)),this._trigger({change:"insert",index:t,items:e},r)},remove:function(t,e){var n,r=this._data;return void 0===t&&(t=r.length-1),t=y(t),e=e?y(e):0===e?0:1,e>0&&t>-1&&(n=r.slice(t,t+e),(e=n.length)&&this._remove(t,e,n)),this},_remove:function(t,e,n){var r=this._data,i=r.length;r.splice(t,e),this._trigger({change:"remove",index:t,items:n},i)},move:function(t,e,n){return n=n?y(n):0===n?0:1,t=y(t),e=y(e),n>0&&t>-1&&e>-1&&t!==e&&this._move(t,e,n),this},_move:function(t,e,n){var r,i=this._data,o=i.length,s=t+n-o;s>0&&(n-=s),n&&(r=i.splice(t,n),e>i.length&&(e=i.length),g.apply(i,[e,0].concat(r)),e!==t&&this._trigger({change:"move",oldIndex:t,index:e,items:r},o))},refresh:function(t){function e(){i&&(a.insert(r-i,c),p+=i,n+=i,i=0,c=[])}var n,r,i,o,s,a=this,c=[],f=a._data,l=f.slice(),u=f.length,p=u,d=t.length;for(a._srt=!0,r=i=0;r<d;r++)if((o=t[r])===f[r-i])e();else{for(n=r-i;n<p&&o!==f[n];n++);if(n<p){for(e(),s=0;s++<d-n&&t[r+s]===f[n+s];);a.move(n,r,s),r+=s-1}else i++,c.push(o)}return e(),p>r&&a.remove(r,p-r),a._srt=void 0,a._trigger({change:"refresh",oldItems:l},u),a},_trigger:function(t,n){var r=this,i=r._data,o=i.length,s=e([i]);r._srt?t.refresh=!0:o!==n&&s.triggerHandler(I,{change:"set",path:"length",value:o,oldValue:n}),s.triggerHandler(j+(r._ns?"."+/^\S+/.exec(r._ns)[0]:""),t)}},v[I]=v[j]={remove:function(t){var n,r,i,o,s,a=t.data;if(a&&(a.off=!0,a=a.cb)&&(n=w[a._cId])){for(i=e._data(this).events[t.type],o=i.length;o--&&!r;)r=(s=i[o].data)&&s.cb&&s.cb._cId===a._cId;r||(delete n[k(this).obId],Q(n,a._cId))}}},a.map=function(t){function n(e,n,r,o){var s,a=this;this.src&&this.unmap(),typeof e===h&&(a.src=e,a.tgt=r||a.tgt||[],a.options=n||a.options,a.update(),o||(t.obsSrc&&i(a.src).observeAll(a.obs=function(e,n){s||(s=!0,t.obsSrc(a,e,n),s=void 0)},a.srcFlt),t.obsTgt&&i(a.tgt).observeAll(a.obt=function(e,n){s||(s=!0,t.obsTgt(a,e,n),s=void 0)},a.tgtFlt)))}return u(t)&&(t={getTgt:t}),t.baseMap&&(t=e.extend({},t.baseMap,t)),t.map=function(t,e,r,i){return new n(t,e,r,i)},(n.prototype={srcFlt:t.srcFlt||E,tgtFlt:t.tgtFlt||E,update:function(e){var n=this;i(n.tgt).refresh(t.getTgt(n.src,n.options=e||n.options))},unmap:function(){var t=this;t.src&&(t.obs&&i(t.src).unobserveAll(t.obs,t.srcFlt),t.obt&&i(t.tgt).unobserveAll(t.obt,t.tgtFlt),t.src=void 0)},map:n,_def:t}).constructor=n,t},c.advSet=function(){c._gccb=this._gccb,t._jsv=f.advanced._jsv?{cbBindings:w}:void 0},c._dp=H}return e},window);
//# sourceMappingURL=jquery.observable.min.js.map
