/*! jsviews.js v1.0.0-alpha single-file version:
includes JsRender, JsObservable and JsViews  http://github.com/BorisMoore/jsrender and http://jsviews.com/jsviews
informal pre V1.0 commit counter: 53 (Beta Candidate) */
(function(n,t,i){"use strict";function kt(n){return n}function ki(n){return n}function dt(n){e._dbgMode=n;yt=n?"Unavailable (nested view): use #getIndex()":"";d("dbg",oi.dbg=lt.dbg=n?ki:kt)}function gt(n){return{getTgt:n,map:function(t){var i=this,r;i.src!==t&&(i.src&&i.unmap(),typeof t=="object"&&(r=n.apply(i,arguments),i.src=t,i.tgt=r))}}}function ft(n,t){t&&t.onError&&t.onError(n)===!1||(this.name=(u.link?"JsViews":"JsRender")+" Error",this.message=n||this.name)}function f(n,t){var i;n=n||{};for(i in t)n[i]=t[i];return n}function ni(n,t,i){return(!h.rTag||n)&&(p=n?n.charAt(0):p,w=n?n.charAt(1):w,o=t?t.charAt(0):o,a=t?t.charAt(1):a,g=i||g,n="\\"+p+"(\\"+g+")?\\"+w,t="\\"+o+"\\"+a,y="(?:(?:(\\w+(?=[\\/\\s\\"+o+"]))|(?:(\\w+)?(:)|(>)|!--((?:[^-]|-(?!-))*)--|(\\*)))\\s*((?:[^\\"+o+"]|\\"+o+"(?!\\"+a+"))*?)",h.rTag=y+")",y=new RegExp(n+y+"(\\/)?|(?:\\/(\\w+)))"+t,"g"),vt=new RegExp("<.*>|([^\\\\]|^)[{}]|"+n+".*"+t)),[p,w,o,a,g]}function di(n,t){t||(t=n,n=i);var e,f,o,u,r=this,s=!t||t==="root";if(n){if(u=r.type===t?r:i,!u)if(e=r.views,r._.useKey){for(f in e)if(u=e[f].get(n,t))break}else for(f=0,o=e.length;!u&&f<o;f++)u=e[f].get(n,t)}else if(s)while(r.parent.parent)u=r=r.parent;else while(r&&!u)u=r.type===t?r:i,r=r.parent;return u}function ti(){var n=this.get("item");return n?n.index:i}function ii(){return this.index}function gi(t){var u,e=this,o=e.linkCtx,r=(e.ctx||{})[t];return r===i&&o&&o.ctx&&(r=o.ctx[t]),r===i&&(r=oi[t]),r&&at(r)&&!r._wrp&&(u=function(){return r.apply(!this||this===n?e:this,arguments)},u._wrp=1,f(u,r)),u||r}function nr(n,t,u){var f,e,h,o=+u===u&&u,s=t.linkCtx;if(o&&(u=(o=t.tmpl.bnds[o-1])(t.data,t,r)),e=u.args[0],n||o){f=s&&s.tag||{_:{inline:!s,bnd:o},tagName:n+":",flow:!0,_is:"tag"};for(h in u.props)rt.test(h)&&(f[h]=u.props[h]);s&&(s.tag=f,f.linkCtx=f.linkCtx||s,u.ctx=l(u.ctx,s.view.ctx));f.tagCtx=u;u.view=t;f.ctx=u.ctx||{};delete u.ctx;t._.tag=f;e=et(f,f.convert||n!=="true"&&n)[0];e=e!=i?e:"";e=o&&t._.onRender?t._.onRender(e,t,o):e;t._.tag=i}return e}function et(n,t){var r=n.tagCtx,u=r.view,i=r.args;return t=t&&(""+t===t?u.getRsc("converters",t)||v("Unknown converter: '"+t+"'"):t),i=!i.length&&!r.index&&n.autoBind?[u.data]:t?i.slice():i,t&&(t.depends&&(n.depends=h.getDeps(n.depends,n,t.depends,t)),i[0]=t.apply(n,i)),i}function tr(n,t){for(var f,e,u=this;f===i&&u;)e=u.tmpl[n],f=e&&e[t],u=u.parent;return f||r[n][t]}function ir(n,t,u,e,o){var ct,h,wt,at,ut,a,vt,w,c,ft,tt,bt,k,yt,pt,nt,y,st,d,kt,g="",ht=+e===e&&e,p=t.linkCtx||0,it=t.ctx,dt=u||t.tmpl;for(n._is==="tag"&&(h=n,n=h.tagName),h=h||p.tag,ht&&(e=(bt=dt.bnds[ht-1])(t.data,t,r)),vt=e.length,a=0;a<vt;a++){if(c=e[a],d=c.props,tt=c.tmpl,tt=c.content=tt&&dt.tmpls[tt-1],u=c.props.tmpl,a||u&&h||(k=t.getRsc("tags",n)||v("Unknown tag: {{"+n+"}}")),u=u||(h?h:k).template||tt,u=""+u===u?t.getRsc("templates",u)||s(u):u,f(c,{tmpl:u,render:ot,index:a,view:t,ctx:l(c.ctx,it)}),!h){k._ctr?(h=new k._ctr,yt=!!h.init,h.attr=h.attr||k.attr||i):h={render:k.render};h._={inline:!p};p&&(p.attr=h.attr=p.attr||h.attr,p.tag=h,h.linkCtx=p);(h._.bnd=bt||p.fn)?h._.arrVws={}:h.dataBoundOnly&&v("{^{"+n+"}} tag must be data-bound");h.tagName=n;h.parent=ut=it&&it.tag;h._is="tag";h._def=k;for(st in d=c.props)rt.test(st)&&(h[st]=d[st])}c.tag=h;h.map&&h.tagCtxs&&(c.map=h.tagCtxs[a].map);h.flow||(ft=c.ctx=c.ctx||{},wt=h.parents=ft.parentTags=it&&l(ft.parentTags,it.parentTags)||{},ut&&(wt[ut.tagName]=ut),ft.tag=h)}for(h.tagCtxs=e,t._.tag=h,h.rendering={},a=0;a<vt;a++)c=h.tagCtx=e[a],d=c.props,y=et(h,h.convert),(pt=d.map||h).map&&(y.length||d.map)&&(nt=c.map=f(c.map||{unmap:pt.unmap},d),nt.src!==y[0]&&(nt.src&&nt.unmap(),pt.map.apply(nt,y)),y=[nt.tgt]),h.ctx=c.ctx,!a&&yt&&(kt=h.template,h.init(c,p,h.ctx),yt=i,h.template!==kt&&(h._.tmpl=h.template)),w=i,ct=h.render,(ct=h.render)&&(w=ct.apply(h,y)),y=y.length?y:[t],w=w!==i?w:c.render(y[0],!0)||(o?i:""),g=g?g+(w||""):w;return delete h.rendering,h.tagCtx=h.tagCtxs[0],h.ctx=h.tagCtx.ctx,h._.inline&&(at=h.attr)&&at!==b&&(g=at==="text"?lt.html(g):""),ht&&t._.onRender?t._.onRender(g,t,ht):g}function nt(n,t,i,r,u,f,e,o){var a,h,c,v=t==="array",l={key:0,useKey:v?0:1,id:""+bi++,onRender:o,bnds:{}},s={data:r,tmpl:u,content:e,views:v?[]:{},parent:i,type:t,get:di,getIndex:ii,getRsc:tr,hlp:gi,_:l,_is:"view"};return i?(a=i.views,h=i._,h.useKey?(a[l.key="_"+h.useKey++]=s,s.index=yt,s.getIndex=ti,c=h.tag,l.bnd=v&&(!c||!!c._.bnd&&c)):a.splice(l.key=s.index=f,0,s),s.ctx=n||i.ctx):s.ctx=n,s}function rr(n){var t,i,r,u,f;for(t in k)if(u=k[t],(f=u.compile)&&(i=n[t+"s"]))for(r in i)i[r]=f(r,i[r],n,t,u)}function ur(n,t,i){var u,r;return at(t)?t={depends:t.depends,render:t}:((r=t.template)&&(t.template=""+r===r?s[r]||s(r):r),t.init!==!1&&(u=t._ctr=function(){},(u.prototype=t).constructor=u)),i&&(t._parentTmpl=i),t}function ri(r,u,f,e,o,h){function v(i){if(""+i===i||i.nodeType>0){try{a=i.nodeType>0?i:!vt.test(i)&&t&&t(n.document).find(i)[0]}catch(u){}return a&&(i=a.getAttribute(bt),r=r||i,i=s[i],i||(r=r||"_"+wi++,a.setAttribute(bt,r),i=s[r]=ri(r,a.innerHTML,f,e,o,h)),a=null),i}}var c,a;return u=u||"",c=v(u),h=h||(u.markup?u:{}),h.tmplName=r,f&&(h._parentTmpl=f),!c&&u.markup&&(c=v(u.markup))&&c.fn&&(c.debug!==u.debug||c.allowCode!==u.allowCode)&&(c=c.markup),c!==i?(r&&!f&&(ut[r]=function(){return u.render.apply(u,arguments)}),c.fn||u.fn?c.fn&&(u=r&&r!==c.tmplName?l(h,c):c):(u=ui(c,h),st(c.replace(li,"\\$&"),u)),rr(h),u):void 0}function ui(n,t){var i,o=e.wrapMap||{},r=f({markup:n,tmpls:[],links:{},tags:{},bnds:[],_is:"template",render:ot},t);return t.htmlTag||(i=yi.exec(n),r.htmlTag=i?i[1].toLowerCase():""),i=o[r.htmlTag],i&&i!==o.div&&(r.markup=u.trim(r.markup)),r}function fr(n,t){function u(e,o,s){var a,c,v,l;if(e&&""+e!==e&&!e.nodeType&&!e.markup){for(v in e)u(v,e[v],o);return r}return o===i&&(o=e,e=i),e&&""+e!==e&&(s=o,o=e,e=i),l=s?s[f]=s[f]||{}:u,c=t.compile,(a=h.onBeforeStoreItem)&&(c=a(l,e,o,c)||c),e?o===null?delete l[e]:l[e]=c?o=c(e,o,s,n,t):o:o=c(i,o),c&&o&&(o._is=n),(a=h.onStoreItem)&&a(l,e,o,c),o}var f=n+"s";r[f]=u;k[n]=t}function ot(n,t,f,e,o,h){var w,et,tt,y,it,rt,ut,k,p,ft,d,ot,c,a=this,st=!a.attr||a.attr===b,g="";if(!!t===t&&(f=t,t=i),o===!0&&(ut=!0,o=0),a.tag?(k=a,a=a.tag,ft=a._,ot=a.tagName,c=ft.tmpl||k.tmpl,t=l(t,a.ctx),p=k.content,k.props.link===!1&&(t=t||{},t.link=!1),e=e||k.view,n=arguments.length?n:e):c=a.jquery&&(a[0]||v('Unknown template: "'+a.selector+'"'))||a,c&&(!e&&n&&n._is==="view"&&(e=n),e&&(p=p||e.content,h=h||e._.onRender,n===e&&(n=e.data),t=l(t,e.ctx)),e&&e.data!==i||((t=t||{}).root=n),c.fn||(c=s[c]||s(c)),c)){if(h=(t&&t.link)!==!1&&st&&h,d=h,h===!0&&(d=i,h=e._.onRender),t=c.helpers?l(c.helpers,t):t,u.isArray(n)&&!f)for(y=ut?e:o!==i&&e||nt(t,"array",e,n,c,o,p,h),w=0,et=n.length;w<et;w++)tt=n[w],it=nt(t,"item",y,tt,c,(o||0)+w,p,h),rt=c.fn(tt,it,r),g+=y._.onRender?y._.onRender(rt,it):rt;else y=ut?e:nt(t,ot||"data",e,n,c,o,p,h),ft&&!a.flow&&(y.tag=a),g+=c.fn(n,y,r);return d?d(g,y):g}return""}function v(n){throw new h.Err(n);}function c(n){v("Syntax error\n"+n)}function st(n,t,i,r){function v(t){t-=f;t&&s.push(n.substr(f,t).replace(it,"\\n"))}function h(t){t&&c('Unmatched or missing tag: "{{/'+t+'}}" in template:\n'+n)}function p(e,y,p,k,d,g,nt,tt,ut,ft,et,ot){g&&(d=":",k=b);ft=ft||i;var pt,lt,at=y&&[],ct="",st="",vt="",yt=!ft&&!d&&!nt;p=p||(ut=ut||"#data",d);v(ot);f=ot+e.length;tt?w&&s.push(["*","\n"+ut.replace(ci,"$1")+"\n"]):p?(p==="else"&&(vi.test(ut)&&c('for "{{else if expr}}" use "{{else expr}}"'),at=u[6],u[7]=n.substring(u[7],ot),u=o.pop(),s=u[3],yt=!0),ut&&(ut=ut.replace(it," "),ct=ht(ut,at,t).replace(ai,function(n,t,i){return t?vt+=i+",":st+=i+",",a=a||rt.test(i.split(":")[0]),""})),st=st.slice(0,-1),ct=ct.slice(0,-1),pt=st&&st.indexOf("noerror:true")+1&&st||"",l=[p,k||!!r||a||"",ct,yt&&[],'\n\tparams:"'+ut+'",\n\tprops:{'+st+"}"+(vt?",ctx:{"+vt.slice(0,-1)+"}":""),pt,at||0],s.push(l),yt&&(o.push(u),u=l,u[7]=f)):et&&(lt=u[0],h(et!==lt&&lt!=="else"&&et),u[7]=n.substring(u[7],ot),u=o.pop());h(!u&&et);s=u[3]}var l,a,w=t&&t.allowCode,e=[],f=0,o=[],s=e,u=[,,,e];return h(o[0]&&o[0][3].pop()[0]),n.replace(y,p),v(n.length),(f=e[e.length-1])&&h(""+f!==f&&+f[7]===f[7]&&f[0]),fi(e,i?n:t,i)}function fi(n,i,r){var a,f,o,l,v,p,ht,ct,lt,at,et,w,s,ot,y,tt,k,rt,vt,d,yt,pt,st,ut,g,h=0,u="",nt="",ft={},wt=n.length;for(""+i===i?(y=r?'data-link="'+i.replace(it," ").slice(1,-1)+'"':i,i=0):(y=i.tmplName||"unnamed",i.allowCode&&(ft.allowCode=!0),i.debug&&(ft.debug=!0),w=i.bnds,ot=i.tmpls),a=0;a<wt;a++)if(f=n[a],""+f===f)u+='\nret+="'+f+'";';else if(o=f[0],o==="*")u+=""+f[1];else{if(l=f[1],v=f[2],rt=f[3],p=f[4],nt=f[5],vt=f[7],(pt=o==="else")||(h=0,w&&(s=f[6])&&(h=w.push(s))),(st=o===":")?(l&&(o=l===b?">":l+o),nt&&(ut="prm"+a,nt="try{var "+ut+"=["+v+"][0];}catch(e){"+ut+'="";}\n',v=ut)):(rt&&(tt=ui(vt,ft),tt.tmplName=y+"/"+o,fi(rt,tt),ot.push(tt)),pt||(k=o,yt=u,u=""),d=n[a+1],d=d&&d[0]==="else"),p+=",\n\targs:["+v+"]}",st&&(s||l&&l!==b)){if(g=new Function("data,view,j,u"," // "+y+" "+h+" "+o+"\n"+nt+"return {"+p+";"),g.paths=s,g._ctxs=o,r)return g;et=1}if(u+=st?"\n"+(s?"":nt)+(r?"return ":"ret+=")+(et?(et=0,at=!0,'c("'+l+'",view,'+(s?(w[h-1]=g,h):"{"+p)+");"):o===">"?(ct=!0,"h("+v+");"):(lt=!0,"(v="+v+")!="+(r?"=":"")+'u?v:"";')):(ht=!0,"{view:view,tmpl:"+(rt?ot.length:"0")+","+p+","),k&&!d){if(u="["+u.slice(0,-1)+"]",(r||s)&&(u=new Function("data,view,j,u"," // "+y+" "+h+" "+k+"\nreturn "+u+";"),s&&((w[h-1]=u).paths=s),u._ctxs=o,r))return u;u=yt+'\nret+=t("'+k+'",view,this,'+(h||u)+");";s=0;k=0}}u="// "+y+"\nvar j=j||"+(t?"jQuery.":"js")+"views"+(lt?",v":"")+(ht?",t=j._tag":"")+(at?",c=j._cnvt":"")+(ct?",h=j.converters.html":"")+(r?";\n":',ret="";\n')+(e.tryCatch?"try{\n":"")+(ft.debug?"debugger;":"")+u+(r?"\n":"\nreturn ret;\n")+(e.tryCatch?"\n}catch(e){return j._err(e);}":"");try{u=new Function("data,view,j,u",u)}catch(bt){c("Compiled template code:\n\n"+u,bt)}return i&&(i.fn=u),u}function ht(n,t,i){function b(b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,ct,lt,at,vt,yt,pt,wt,bt){function dt(n,i,r,f,e,o,c,l){if(r&&(t&&(u==="linkTo"&&(s=t._jsvto=t._jsvto||[],s.push(nt)),(!u||h)&&t.push(nt.slice(i.length))),r!==".")){var a=(f?'view.hlp("'+f+'")':e?"view":"data")+(l?(o?"."+o:f?"":e?"":"."+r)+(c||""):(l=f?"":e?o||"":r,""));return a=a+(l?"."+l:""),i+(a.slice(0,9)==="view.data"?a.slice(5):a)}return n}var kt;if(tt=tt||"",d=d||k||ot,nt=nt||ut,ft=ft||yt||"",!it||e||f)return t&&vt&&!e&&!f&&(!u||h||s)&&(kt=v[r],bt.length-1>wt-kt&&(kt=bt.slice(kt,wt+1),vt=w+":"+kt+o,vt=y[vt]=y[vt]||st(p+vt+a,i,!0),vt.paths||ht(kt,vt.paths=[],i),(s||t).push({_jsvOb:vt}))),e?(e=!ct,e?b:'"'):f?(f=!lt,f?b:'"'):(d?(r++,v[r]=wt++,d):"")+(pt?r?"":u?(u=h=s=!1,"\b"):",":rt?(r&&c(n),u=nt,h=g,"\b"+nt+":"):nt?nt.split("^").join(".").replace(si,dt)+(ft?(l[++r]=!0,nt.charAt(0)!=="."&&(v[r]=wt),ft):tt):tt?tt:at?(l[r--]=!1,at)+(ft?(l[++r]=!0,ft):""):et?(l[r]||c(n),","):k?"":(e=ct,f=lt,'"'));c(n)}var u,s,h,y=i.links,l={},v={0:-1},r=0,f=!1,e=!1;return(n+" ").replace(/\)\^/g,").").replace(hi,b)}function l(n,t){return n&&n!==t?t?f(f({},t),n):n:t&&f({},t)}function ei(n){return wt[n]||(wt[n]="&#"+n.charCodeAt(0)+";")}function er(n){var i,t,r=[];if(typeof n=="object")for(i in n)t=n[i],t&&t.toJSON&&!t.toJSON()||at(t)||r.push({key:i,prop:n[i]});return r}if((!t||!t.views)&&!n.jsviews){var u,tt,y,vt,yt,p="{",w="{",o="}",a="}",g="^",si=/^(!*?)(?:null|true|false|\d[\d.]*|([\w$]+|\.|~([\w$]+)|#(view|([\w$]+))?)([\w$.^]*?)(?:[.[^]([\w$]+)\]?)?)$/g,hi=/(\()(?=\s*\()|(?:([([])\s*)?(?:(\^?)(!*?[#~]?[\w$.^]+)?\s*((\+\+|--)|\+|-|&&|\|\||===|!==|==|!=|<=|>=|[<>%*:?\/]|(=))\s*|(!*?[#~]?[\w$.^]+)([([])?)|(,\s*)|(\(?)\\?(?:(')|("))|(?:\s*(([)\]])(?=\s*\.|\s*\^|\s*$)|[)\]])([([]?))|(\s+)/g,it=/[ \t]*(\r\n|\n|\r)/g,ci=/\\(['"])/g,li=/['"\\]/g,ai=/\x08(~)?([^\x08]+)\x08/g,vi=/^if\s/,yi=/<(\w+)[>\s]/,pt=/[\x00`><"'&]/g,rt=/^on[A-Z]|^convert(Back)?$/,pi=pt,wi=0,bi=0,wt={"&":"&amp;","<":"&lt;",">":"&gt;","\x00":"&#0;","'":"&#39;",'"':"&#34;","`":"&#96;"},b="html",bt="data-jsv-tmpl",ut={},k={template:{compile:ri},tag:{compile:ur},helper:{},converter:{}},r={jsviews:"v1.0.0-beta",render:ut,settings:function(n){f(e,n);dt(e._dbgMode);e.jsv&&e.jsv()},sub:{View:nt,Err:ft,tmplFn:st,cvt:et,parse:ht,extend:f,err:v,syntaxErr:c,isFn:function(n){return typeof n=="function"},DataMap:gt},_cnvt:nr,_tag:ir,_err:function(n){return e._dbgMode?"Error: "+(n.message||n)+". ":""}};(ft.prototype=new Error).constructor=ft;ti.depends=function(){return[this.get("item"),"index"]};ii.depends=function(){return["index"]};for(tt in k)fr(tt,k[tt]);var ct,s=r.templates,lt=r.converters,oi=r.helpers,d=r.tags,h=r.sub,at=h.isFn,e=r.settings;t?(u=t,u.fn.render=ot,(ct=u.observable)&&(f(h,ct.sub),delete ct.sub)):(u=n.jsviews={},u.isArray=Array&&Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"});u.render=ut;u.views=r;u.templates=s=r.templates;e({debugMode:dt,delimiters:ni,_dbgMode:!0,tryCatch:!0});d({"else":function(){},"if":{render:function(n){var t=this;return t.rendering.done||!n&&(arguments.length||!t.tagCtx.index)?"":(t.rendering.done=!0,t.selected=t.tagCtx.index,t.tagCtx.render(t.tagCtx.view,!0))},onUpdate:function(n,t,i){for(var r,f,u=0;(r=this.tagCtxs[u])&&r.args.length;u++)if(r=r.args[0],f=!r!=!i[u].args[0],!this.convert&&!!r||f)return f;return!1},flow:!0},"for":{render:function(n){var f,t=this,r=t.tagCtx,e="",o=0;return t.rendering.done||((f=!arguments.length)&&(n=r.view.data),n!==i&&(e+=r.render(n,f),o+=u.isArray(n)?n.length:1),(t.rendering.done=o)&&(t.selected=r.index)),e},flow:!0,autoBind:!0},include:{flow:!0,autoBind:!0},"*":{render:kt,flow:!0}});d({props:f(f({},d["for"]),gt(er))});d.props.autoBind=!0;lt({html:function(n){return n!=i?String(n).replace(pi,ei):""},attr:function(n){return n!=i?String(n).replace(pt,ei):n===null?n:""},url:function(n){return n!=i?encodeURI(String(n)):n===null?n:""}});ni()}})(this,this.jQuery),function(n,t,i){"use strict";function f(n){return r(n)?new k(n):new b(n)}function b(n){return this._data=n,this}function k(n){return this._data=n,this}function ct(n){return r(n)?[n]:n}function rt(n,t){n=r(n)?n:[n];for(var i,e=t,o=e,h=n.length,f=[],s=0;s<h;s++){if(i=n[s],u(i)){f=f.concat(rt(i.call(t,t),t));continue}else if(""+i!==i){t=o=i;o!==e&&f.push(e=o);continue}o!==e&&f.push(e=o);f.push(i)}return f}function ut(n,t){var r,i;for(r in n){i=!0;break}i||delete y[t]}function d(n,t){if(!(n.data&&n.data.off)){var v,y,p,f=t.oldValue,o=t.value,u=n.data,h=u.observeAll,c=!u.cb.noArray,a=u.paths;n.type===l?(u.cb.array||u.cb).call(u,n,t):(u.prop===t.path||u.prop==="*")&&(f=typeof f===s&&(a[0]||c&&r(f))&&f,o=typeof(o=t.value)===s&&(a[0]||c&&r(o))&&o,h?(v=h._path+"."+t.path,y=h.filter,p=[h.parents().slice()],f&&e(c,h.ns,[f],a,u.cb,!0,y,p,v),o&&e(c,h.ns,[o],a,u.cb,i,y,p,v)):(f&&e(c,[f],a,u.cb,!0),o&&e(c,[o],a,u.cb)),u.cb(n,t))}}function a(){function dt(i,r,u,f){var s,e,y=it(n),p=ct(n);if(i=at?i+"."+at:i,g||f)y&&t(p).off(i,d);else{if(o=y&&t._data(n))for(o=o&&o.events,o=o&&o[u?l:c],kt=o&&o.length;kt--;)if((nt=o[kt].data)&&nt.cb._cId===h._cId&&nt.ns===at){if(u)return;(r==="*"&&nt.prop!==r||nt.prop===v)&&t(n).off(i,d)}e=u?{}:{fullPath:a,paths:r?[r]:[],prop:v};e.ns=at;e.cb=h;lt&&(e.observeAll={_path:lt,path:function(){return s=ii.length,lt.replace(/[[.]/g,function(n){return s--,n==="["?"["+t.inArray(ii[s-1],ii[s]):"."})},parents:function(){return ii},filter:ei,ns:at});t(p).on(i,null,e,d);ni&&(ni[t.data(n,"obId")||t.data(n,"obId",ht++)]=n)}}function vi(n,t){n._ob=yt(n,ft);var i=ft;return function(u,f){var o=n._ob,c=t.length;typeof o===s&&(gt(o,!0),(c||vt&&r(o))&&e(vt,[o],t,h,yt,!0));o=n._ob=yt(n,i);typeof o===s&&(gt(o),(c||vt&&r(o))&&e(vt,[o],t,h,yt,[i]));h(u,f)}}function gt(t,u,e,o){if(vt){var s=n,c=lt;n=t;o&&(n=t[o],lt+="."+o,ei&&(n=f._fltr(o,t,lt,ei)));n&&(e||r(n))&&dt(l+".observe"+(h?".obs"+(bt=h._cId=h._cId||w++):""),i,!0,u);n=s;lt=c}}var wt,ui,oi,et,v,a,fi,g,h,bt,kt,nt,o,yt,si,ni,ti,hi,ii,lt,ei,at,ci,li,vt=this!=!1,ai=1,ri=st,b=Array.apply(0,arguments),k=b.pop(),ft=b.shift(),pt=ft,n=pt,tt=b.length;for(ft+""===ft&&vt&&(at=ft,ft=n=pt=b.shift(),tt--),u(k)?h=k:(k+""===k&&(lt=k,ii=b.pop(),ei=b.pop(),k=b.pop(),tt=tt-3),k===!0?g=k:k&&(ft=k,ai=0),k=b[tt-1],(tt&&k===i||u(k))&&(h=b.pop(),tt--)),tt&&u(b[tt-1])&&(yt=h,h=b.pop(),tt--),ri+=g?h?".obs"+h._cId:"":".obs"+(bt=h._cId=h._cId||w++),g||(ni=y[bt]=y[bt]||{}),ci=at&&at.match(ot)||[""],li=ci.length;li--;)for(at=ci[li],r(pt)?gt(pt,g,!0):g&&tt===0&&pt&&dt(ri,""),ti=0,wt=0;wt<tt;wt++)if(a=b[wt],a!==""){if(n=pt,""+a===a){if(et=a.split("^"),et[1]&&(ti=et[0].split(".").length,a=et.join("."),ti=a.split(".").length-ti),yt&&(si=yt(a,pt))){tt+=si.length-1;p.apply(b,[wt--,1].concat(si));continue}et=a.split(".")}else ai&&!u(a)&&(a._jsvOb&&(a._cb=hi=vi(a,b.slice(wt+1)),hi.noArray=vt===!1,hi._cId=h._cId,e(vt,[ft],b.slice(0,wt),a._cb,yt),a=a._ob),n=a),pt=a,et=[pt];while(n&&(v=et.shift())!==i)if(typeof n===s){if(""+v===v){if(v==="")continue;if(et.length<ti+1&&!n.nodeType){if(!g&&(o=it(n)&&t._data(n))){for(o=o.events,o=o&&o[c],kt=o&&o.length,oi=0;kt--;)nt=o[kt].data,nt&&nt.cb===h&&nt.ns===at&&(nt.prop===v||nt.prop==="*")&&((ui=et.join("."))&&nt.paths.push(ui),oi++);if(oi){n=n[v];continue}}if(v==="*"){!g&&o&&o.length&&dt(ri,"",!1,!0);u(n)?(fi=n.depends)&&e(vt,[fi],h,g||ft):dt(ri,"");for(ui in n)gt(n,g,i,ui);break}else v&&dt(ri+"."+v,et.join("."))}lt&&(lt+="."+v);v=n[v]}if(u(v)){(fi=v.depends)&&e(vt,[n],rt(fi,n),h,yt,g||[ft]);break}n=v}gt(n,g)}return bt&&ut(ni,bt),{cbId:bt,bnd:ni,leaf:n}}function lt(){return[].push.call(arguments,!0),a.apply(this,arguments)}function e(){var n=[].concat.apply([],arguments);return a.apply(n.shift(),n)}function ft(n,t,i){return i.indexOf(".")<0&&i.indexOf("[")<0&&t[n]}function at(n,r,u,f,e){return f=f||ft,e=e||ft,{getTgt:n,obsSrc:r,obsTgt:u,map:function(i){var o=this,h,c;return o.src!==i&&(o.src&&o.unmap(),typeof i===s&&(c=n.apply(o,arguments),t.observable&&(t.observable(i).observeAll(o.obs=function(n,t){!h&&r&&(h=!0,r.call(o,i,c,n,t),h=!1)},f),t.observable(c).observeAll(o.obt=function(n,t){!h&&u&&(h=!0,u.call(o,i,c,n,t),h=!1)},e)),o.src=i,o.tgt=c)),o},unmap:function(){if(t.observable){var n=this;n.src&&(t.observable(n.src).unobserveAll(n.obs,f),t.observable(n.tgt).unobserveAll(n.obt,e),n.src=n.tgt=i)}}}}function g(n,t,i,r){n+""!==n&&(i=t,t=n,n="");v(n,this._data,t,i,[],"root",r)}function et(n,t,i){g.call(this,n,t,i,!0)}function v(n,t,u,e,o,h,c){function p(t,i){for(y=t.length,l=h+"[]";y--;)(k=f._fltr(y,t,l,e))&&v(n,k,u,e||"",o.slice(),l,i)}function d(t,i){h=t.data.observeAll._path;var r=o;o[0]!==t.target&&(o=o.slice(),o.unshift(t.target));switch(i.change){case"insert":p(i.items);break;case"remove":p(i.items,!0);break;case"refresh":p(i.oldItems,!0);p(t.target);break;case"set":l=h+"."+i.path;v(n,i.oldValue,u,0,o.slice(),l,!0);v(n,i.value,u,0,o.slice(),l)}u.apply(this,arguments);o=r}var y,b,l,k;if(typeof t===s)if(b=r(t)?"":"*",o.unshift(t),u?(b||e!==0)&&(d._cId=u._cId=u._cId||w++,a(n,t,b,d,c,e,o.slice(),h)):a(n,t,b,i,c,e,o.slice(),h),b)for(y in t)y.charAt(0)!=="_"&&y!==tt&&(l=h+"."+y,(k=f._fltr(y,t,l,e))&&v(n,k,u,e||0,o.slice(),l,c));else p(t,c)}if(!t)throw"jsViews/jsObservable require jQuery";if(!t.observable){var nt=t.event.special,o=t.views?t.views.sub:f.sub={},p=[].splice,r=t.isArray,tt=t.expando,s="object",h=parseInt,ot=/\S+/g,c=o.propChng=o.propChng||"propertyChange",l=o.arrChng=o.arrChng||"arrayChange",y=o._cbBnds=o._cbBnds||{},st=c+".observe",u=o.isFn,ht=1,w=1,it=t.hasData;o.getDeps=function(){var n=arguments;return function(){for(var i,t,r=[],f=n.length;f--;)i=n[f--],t=n[f],t&&(r=r.concat(u(t)?t(i,i):t));return r}};o.DataMap=at;t.observable=f;f._fltr=function(n,t,i,r){var f=r&&u(r)?r(n,t,i):t[n];return f&&(f=u(f)?f.set&&f.call(t):f),typeof f===s&&f};f.Object=b;f.Array=k;t.observe=f.observe=a;t.unobserve=f.unobserve=lt;f._apply=e;b.prototype={_data:null,observeAll:g,unobserveAll:et,data:function(){return this._data},setProperty:function(n,t,u){var f,h,s,e=this,o=e._data;if(n=n||"",o)if(r(n))for(f=n.length;f--;)h=n[f],e.setProperty(h.name,h.value,u===i||u);else if(""+n!==n)for(f in n)e.setProperty(f,n[f],t);else if(n!==tt){for(s=n.split(".");o&&s.length>1;)o=o[s.shift()];e._setProperty(o,s.join("."),t,u)}return e},_setProperty:function(n,t,i,r){var e,o,f=t?n[t]:n;u(f)&&f.set&&(o=f,e=f.set===!0?f:f.set,f=f.call(n));(f!==i||r&&f!=i)&&(!(f instanceof Date)||f>i||f<i)&&(e?(e.call(n,i),i=o.call(n)):t&&(n[t]=i),this._trigger(n,{change:"set",path:t,value:i,oldValue:f}))},_trigger:function(n,i){t(n).triggerHandler(c,i)}};k.prototype={_data:null,observeAll:g,unobserveAll:et,data:function(){return this._data},insert:function(n,t){var i=this._data;return arguments.length===1&&(t=n,n=i.length),n=h(n),n>-1&&n<=i.length&&(t=r(t)?t:[t],t.length&&this._insert(n,t)),this},_insert:function(n,t){var i=this._data,r=i.length;p.apply(i,[n,0].concat(t));this._trigger({change:"insert",index:n,items:t},r)},remove:function(n,t){var r,u=this._data;return n===i&&(n=u.length-1),n=h(n),t=t?h(t):t===0?0:1,t>-1&&n>-1&&(r=u.slice(n,n+t),t=r.length,t&&this._remove(n,t,r)),this},_remove:function(n,t,i){var r=this._data,u=r.length;r.splice(n,t);this._trigger({change:"remove",index:n,items:i},u)},move:function(n,t,i){if(i=i?h(i):i===0?0:1,n=h(n),t=h(t),i>0&&n>-1&&t>-1&&n!==t){var r=this._data.slice(n,n+i);i=r.length;i&&this._move(n,t,i,r)}return this},_move:function(n,t,i,r){var u=this._data,f=u.length;u.splice(n,i);u.splice.apply(u,[t,0].concat(r));this._trigger({change:"move",oldIndex:n,index:t,items:r},f)},refresh:function(n){var t=this._data.slice();return this._refresh(t,n),this},_refresh:function(n,t){var i=this._data,r=i.length;p.apply(i,[0,i.length].concat(t));this._trigger({change:"refresh",oldItems:n},r)},_trigger:function(n,i){var r=this._data,u=r.length,f=t([r]);f.triggerHandler(l,n);u!==i&&f.triggerHandler(c,{change:"set",path:"length",value:u,oldValue:i})}};nt[c]=nt[l]={remove:function(n){var r,u,f,e,o,i=n.data;if(i&&(i.off=1,i=i.cb)&&(r=y[i._cId])){for(f=t._data(this).events[n.type],e=f.length;e--&&!u;)u=(o=f[e].data)&&o.cb===i;u||(delete r[t.data(this,"obId")],ut(r,i._cId))}}}}}(this,this.jQuery),function(n,t,i){"use strict";function sr(n){var t=this.linkedElem;t&&et({target:t[0]},n)}function et(n,r){var p,nt,h,f,w,l,e,b,o,a,tt,k,g,u,s,v,y=n.target,it=y._jsvBnd,ut=/&(\d+)\+?/g;if(it)while(a=ut.exec(it))if((a=c[a[1]])&&(s=a.to)){if(f=a.linkCtx,o=f.view,u=f.tag,b=t(y),k=o.hlp(wt),g=o.hlp(bt),h=ot(y),p=gt[h],r===i&&(r=rt(h)?h(y):p?b[p]():b.attr(h)),l=s[1],s=s[0],l&&(w=rt(l)?l:o.getRsc("converters",l)),w&&(r=w.call(u,r)),tt=o.linkCtx,o.linkCtx=f,v={change:"change",oldValue:f._val,value:r},(!k||!(nt=k.call(f,n,v)===!1))&&(!u||!u.onBeforeChange||!(nt=u.onBeforeChange(n,v)===!1))&&r!==i&&(e=s[0],r!==i&&e)){if(e=e._jsvOb?e._ob:e,u&&(u._.chging=!0),d(e).setProperty(s[2]||s[1],r),g&&g.call(f,n,v),u){if(u.onAfterChange)u.onAfterChange(n,v);delete u._.chging}f._val=r}o.linkCtx=tt}}function yu(n,t,u){var c,s,f,e=this,y=e.data,a=e.elem,l=e.convert,p=a.parentNode,b=p,o=e.view,k=o.ctx,w=o.linkCtx,v=o.hlp(wt);if(o.linkCtx=e,p&&(!v||!(t&&v.call(e,n,t)===!1))&&!(t&&n.data.prop!=="*"&&n.data.prop!==t.path)){if(t&&(e.eventArgs=t),t||e._initVal){if(delete e._initVal,s=u.call(o.tmpl,y,o,r),c=pu(s,e,f,e.attr||ot(a,!0,l!==i)),f=e.tag){if(t&&f.onUpdate&&f.onUpdate(n,t,s=s[0]?s:[s])===!1||c==="none"){f.tagCtxs=s;f.tagCtx=s[0];c===h&&f.onBeforeLink&&f.onBeforeLink();ct(f,f.tagCtx);oi(e,y,a);o.linkCtx=w;return}if(f._.chging)return;s=f.tagName.slice(-1)===":"?r._cnvt(f.tagName.slice(0,-1),o,s):r._tag(f,o,o.tmpl,s,!0)}else u._ctxs&&(l=l===""?"true":l,s=l?r._cnvt(l,o,s):r._tag(u._ctxs,o,o.tmpl,s,!0),f=o._.tag,c=e.attr||c);hr(s,e,c,f)&&t&&(v=o.hlp(bt))&&v.call(e,n,t)}f&&(f.contents=ci,f.nodes=li,f.childTags=ai,f.currentCtxs=wr,f.update=sr,f.refresh=kr,ct(f,f.tagCtx));oi(e,y,a);o.linkCtx=w}}function pu(n,r,u,f){var e,h,c,o,s=u&&u.parentElem||r.elem;if(n!==i){if(o=t(s),f=u&&u.attr||f,rt(n)&&it(r.expr+": missing parens"),f==="visible"&&(f="css-display"),c=/^css-/.test(f)&&f.slice(4))e=t.style(s,c),+n===n&&(e=parseInt(e)),e=t.style(s,c);else if(f!=="link"){if(f==="value")s.type===kt&&(e=o.prop(f=p));else if(f===ft)if(s.value===""+n)e=o.prop(p);else return f;e===i&&(h=gt[f],e=h?o[h]():o.attr(f))}r._val=e}return f}function hr(n,r,u,f){var tt,o,c,k,it,w,a,b,v,y,d=n!==i,rt=r.data,e=f&&f.parentElem||r.elem,g=t(e),s=r.view,nt=r._val,ut=s.ctx,et=s.linkCtx,l=f||u===h;if(f&&(f.parentElem=f.parentElem||r.expr||f._elCnt?e:e.parentNode,o=f._prv,c=f._nxt),!d){u===h&&f&&f.onBeforeLink&&f.onBeforeLink();return}if(/^css-/.test(u))r.attr==="visible"&&(n=n?wu(e):"none"),(l=l||nt!==n)&&t.style(e,u.slice(4),n);else if(u!=="link"){if(u===p)w=1,n=n&&n!=="false";else if(u===ft)if(e.value===""+n)n=!0,w=1,u=p;else{oi(r,rt,e);return}else(u==="selected"||u==="disabled"||u==="multiple"||u==="readonly")&&(n=n&&n!=="false"?u:null);(tt=gt[u])?u===h?(s.linkCtx=r,s.ctx=r.ctx,f&&f._.inline?(it=f.nodes(!0),f._elCnt&&(o&&o!==c?pi(o,c,e,f._tgId,"^",!0):(a=e._dfr)&&(b=f._tgId+"^",v=a.indexOf("#"+b)+1,y=a.indexOf("/"+b),v&&y>0&&(v+=b.length,y>v&&(e._dfr=a.slice(0,v)+a.slice(y),gr(a.slice(v,y))))),o=o?o.previousSibling:c?c.previousSibling:e.lastChild),t(it).remove(),f&&f.onBeforeLink&&f.onBeforeLink(),k=s.link(s.data,e,o,c,n,f&&{tag:f._tgId,lazyLink:f.tagCtx.props.lazyLink})):(d&&g.empty(),f&&f.onBeforeLink&&f.onBeforeLink(),d&&(k=s.link(rt,e,o,c,n,f&&{tag:f._tgId}))),s.linkCtx=et,s.ctx=ut):(l=l||nt!==n)&&(u==="text"&&e.children&&!e.children[0]?e.textContent!==i?e.textContent=n:e.innerText=n===null?"":n:g[tt](n)):(l=l||nt!==n)&&g[w?"prop":"attr"](u,n===i&&!w?null:n);r._val=n}return k||l}function cr(n,t){var i=this,r=i.hlp(wt),u=i.hlp(bt);if(!r||r.call(this,n,t)!==!1){if(t){var o=t.change,f=t.index,e=t.items;switch(o){case"insert":i.addViews(f,e);break;case"remove":i.removeViews(f,e.length);break;case"move":i.refresh();break;case"refresh":i.refresh()}}u&&u.call(this,n,t)}}function wu(t){var i,u,f=n.getComputedStyle,r=(t.currentStyle||f.call(n,t,"")).display;return r!=="none"||(r=fr[u=t.nodeName])||(i=e.createElement(u),e.body.appendChild(i),r=(f?f.call(n,i,""):i.currentStyle).display,fr[u]=r,e.body.removeChild(i)),r}function fi(n){var f,e,u=n.data,r=n._.bnd;if(!n._.useKey&&r)if((e=n._.bndArr)&&(t([e[1]]).off(pt,e[0]),n._.bndArr=i),r!==!!r&&r._.inline)u?r._.arrVws[n._.id]=n:delete r._.arrVws[n._.id];else if(u){f=function(t){t.data&&t.data.off||cr.apply(n,arguments)};t([u]).on(pt,f);n._.bndArr=[f,u]}}function ot(n,t,i){var u=n.nodeName.toLowerCase(),r=f.merge[u]||n.contentEditable==="true"&&{to:h,from:h};return r?t?u==="input"&&n.type===ft?ft:r.to:r.from:t?i?"text":h:""}function lr(n,r,u,f,e,o,s){var p,c,v,w,b,l=n.parentElem,h=n._prv,a=n._nxt,y=n._elCnt;if(h&&h.parentNode!==l&&it("Missing parentNode"),s){w=n.nodes();y&&h&&h!==a&&pi(h,a,l,n._.id,"_",!0);n.removeViews(i,i,!0);c=a;y&&(h=h?h.previousSibling:a?a.previousSibling:l.lastChild);t(w).remove();for(b in n._.bnds)lt(b)}else{if(r){if(v=f[r-1],!v)return!1;h=v._nxt}y?(c=h,h=c?c.previousSibling:l.lastChild):c=h.nextSibling}p=u.render(e,o,n._.useKey&&s,n,s||r,!0);n.link(e,l,h,c,p,v)}function ei(n,t,r){var u,f,e;return r?(e="^`",f=t._.tag||{_:{inline:!0,bnd:r},tagCtx:{view:t},flow:!0},u=f._tgId,u||(c[u=er++]=f,f._tgId=""+u)):(e="_`",y[u=t._.id]=t),"#"+u+e+(n===i?"":n)+"/"+u+e}function oi(n,t,r){var e,l,f,u=n.tag,a=n.convertBack,o=[],h=n._bndId||""+er++,v=n._hdlr;if(delete n._bndId,u&&(o=u.depends||o,o=rt(o)?u.depends(u):o,f=u.linkedElem),(!n._depends||""+n._depends!=""+o)&&(n._depends&&d._apply(!1,[t],n._depends,v,!0),e=d._apply(!1,[t],n.fn.paths,o,v,n._ctxCb),e.elem=r,e.linkCtx=n,e._tgId=h,r._jsvBnd=r._jsvBnd||"",r._jsvBnd+="&"+h,n._depends=o,n.view._.bnds[h]=h,c[h]=e,f&&(e.to=[[],a]),(f||a!==i)&&br(e,u&&u.convertBack||a),u)){if(u.onAfterBind)u.onAfterBind(e);u.flow||u._.inline||(r.setAttribute(s,(r.getAttribute(s)||"")+"#"+h+"^/"+h+"^"),u._tgId=""+h)}if(f&&f[0])for(u._.radio&&(f=f.children("input[type=radio]")),l=f.length;l--;)f[l]._jsvBnd=f[l]._jsvBnd||r._jsvBnd+"+",f[l]._jsvLnkdEl=u}function ar(n,t,i,r,u,f,e){return si(this,n,t,i,r,u,f,e)}function si(n,r,u,o,s,h,c,a){if(n&&r){if(r=r.jquery?r:t(r),!w){w=e.body;t(w).on(nr,et).on("blur","[contenteditable]",function(n){var t=f.noValidate;f.noValidate=!0;et(n);f.noValidate=t})}for(var k,nt,tt,g,p,d,v,it,rt=ei,ft=o&&o.target==="replace",ut=r.length;ut--;)if(v=r[ut],""+n===n)p=b(v),it=p.ctx,p.ctx=o,st(n,v,p,u),p.ctx=it;else{if(h=h||b(v),n.markup!==i)h.link===!1&&(o=o||{},o.link=rt=!1),ft&&(d=v.parentNode),tt=n.render(u,o,s,h,i,rt),d?(c=v.previousSibling,a=v.nextSibling,t.cleanData([v],!0),d.removeChild(v),v=d):(c=a=i,t(v).empty());else if(n!==!0)break;if(v._dfr&&!a){for(g=l(v._dfr,1,or),k=0,nt=g.length;k<nt;k++)p=g[k],(p=y[p.id])&&p.data!==i&&p.parent.removeViews(p._.key,i,!0);v._dfr=""}h.link(u,v,c,a,tt,i,o)}}return r}function bu(n,r,u,h,v,p,w,d){function yu(n,t,r,u,e,o,h,c,l,a,y,p,w){var b,k="";return w?(hi=0,n):(g=c||l||"",u=u||a,r=r||p,pi&&!r&&(u||g||o)&&(pi=i,ut=gt.shift()),u=u||r,u&&(hi=0,pi=i,f.noValidate||(r||p?ui[ut]||(b="'<"+ut+".../"):ui[u]?b="'<\/"+u:gt.length&&u===ut||(b="Mismatch: '<\/"+u),b&&ti(b+">' in:\n"+v)),er=ft,ut=gt.shift(),ft=ri[ut],a=a?"<\/"+a+">":"",er&&(at+=pt,pt="",ft?at+="-":(k=a+ir+"@"+at+tr+(y||""),at=lu.shift()))),ft?(o?pt+=o:t=a||p||"",g&&(t+=g,pt&&(t+=" "+s+'="'+pt+'"',pt=""))):t=o?t+k+e+ir+o+tr+h+g:k||n,hi&&o&&ti(" No {^{ tags within elem markup ("+hi+' ). Use data-link="..."'),g&&(hi=g,gt.unshift(ut),ut=g.slice(1),gt[0]&&gt[0]===ou[ut]&&it("Parent of <tr> must be <tbody>"),pi=ui[ut],(ft=ri[ut])&&!er&&(lu.unshift(at),at=""),er=ft,at&&ft&&(at+="+")),t)}function bi(n,t){var o,l,u,e,f,a,s,h=[];if(n){for(n._tkns.charAt(0)==="@"&&(t=nt.previousSibling,nt.parentNode.removeChild(nt),nt=null),bt=n.length;bt--;){if(ot=n[bt],u=ot.ch,o=ot.path)for(et=o.length-1;l=o.charAt(et--);)l==="+"?o.charAt(et)==="-"?(et--,t=t.previousSibling):t=t.parentNode:t=t.lastChild;u==="^"?(g=c[f=ot.id])&&(s=t&&(!nt||nt.parentNode!==t),(!nt||s)&&(g.parentElem=t),ot.elCnt&&s&&(t._dfr=(ot.open?"#":"/")+f+u+(t._dfr||"")),h.push([s?null:nt,ot])):(rt=y[f=ot.id])&&(rt.link||(rt.parentElem=t||nt&&nt.parentNode||r,k(rt,vt),rt._.onRender=ei,rt._.onArrayChange=cr,fi(rt)),e=rt.parentElem,ot.open?(rt._elCnt=ot.elCnt,t?t._dfr="#"+f+u+(t._dfr||""):(rt._prv||(e._dfr=ht(e._dfr,"#"+f+u)),rt._prv=nt)):(t&&(!nt||nt.parentNode!==t)?(t._dfr="/"+f+u+(t._dfr||""),rt._nxt=i):nt&&(rt._nxt||(e._dfr=ht(e._dfr,"/"+f+u)),rt._nxt=nt),vi=rt.linkCtx,(a=rt.ctx&&rt.ctx.onAfterCreate||wu)&&a.call(vi,rt)))}for(bt=h.length;bt--;)hr.push(h[bt])}return!n||n.elCnt}function pu(n){var t,i;if(n)for(bt=n.length,et=0;et<bt;et++)if(ot=n[et],yt.id)yt.id=yt.id!==ot.id&&yt.id;else if(i=g=c[ot.id].linkCtx.tag,!g.flow){if(!br){for(t=1;i=i.parent;)t++;rr=rr||t}(br||t===rr)&&(!dr||g.tagName===dr)&&vr.push(g)}}function ru(){for(lr=ii?r.querySelectorAll(tt):t(tt,r).get(),ni=lr.length,u&&u.innerHTML&&(ki=ii?u.querySelectorAll(tt):t(tt,u).get(),u=ki.length?ki[ki.length-1]:u),rr=0,wt=0;wt<ni;wt++)if(nt=lr[wt],u&&!su)su=nt===u;else if(h&&nt===h)break;else nt.parentNode&&vu(l(nt,i,vr&&au))&&!yt&&nt.getAttribute(a)&&hr.push([nt]);if(yr(u,ft),yr(h,ft),yt){kt&&kt.resolve();return}for(ft&&at+pt&&(nt=h,at&&(h?bi(l(at+"+",1),h):bi(l(at,1),r)),bi(l(pt,1),r),h&&(lt=h.getAttribute(s),(ni=lt.indexOf(or)+1)&&(lt=lt.slice(ni+or.length-1)),h.setAttribute(s,pt+lt))),ni=hr.length,wt=0;wt<ni;wt++)nt=hr[wt],dt=nt[1],nt=nt[0],dt?(g=c[dt.id])&&((vi=g.linkCtx)&&(g=vi.tag,g.linkCtx=vi),dt.open?(nt&&(g.parentElem=nt.parentNode,g._prv=nt),g._elCnt=dt.elCnt,!g||g.onBeforeLink&&g.onBeforeLink()===!1||g._.bound||(g._.bound=!0,rt=g.tagCtx.view,st(i,g._prv,rt,n,dt.id)),g._.linking=!0):(g._nxt=nt,g._.linking&&(gr=g.tagCtx,rt=gr.view,g.contents=ci,g.nodes=li,g.childTags=ai,g.currentCtxs=wr,g.update=sr,g.refresh=kr,delete g._.linking,g._.bound||(g._.bound=!0,st(i,g._prv,rt,n,dt.id)),ct(g,gr)))):(rt=b(nt),st(nt.getAttribute(a),nt,rt,n,i,w));kt&&kt.resolve()}var hi,vi,g,wt,ni,et,bt,lr,nt,rt,ot,dt,ki,gi,ar,nr,oi,vr,br,dr,gr,rr,yt,uu,nu,eu,yi,ut,pi,wi,fr,lt,ft,er,si,pt,or,su,kt,tu=this,cu=tu._.id+"_",at="",hr=[],gt=[],lu=[],wu=tu.hlp(iu),vu=bi;if(p&&(kt=p.lazyLink&&t.Deferred(),p.tmpl?ar="/"+p._.id+"_":(yt=p.get,p.tag&&(cu=p.tag+"^",p=!0)),p=p===!0),yt&&(vu=pu,vr=yt.tags,br=yt.deep,dr=yt.name),r=r?""+r===r?t(r)[0]:r.jquery?r[0]:r:tu.parentElem||e.body,ut=r.tagName.toLowerCase(),ft=!!ri[ut],u=u&&pr(u,ft),h=h&&pr(h,ft)||null,v!==i){if(fr=e.createElement("div"),wi=fr,or=pt="",si=r.namespaceURI==="http://www.w3.org/2000/svg"?"svg_ns":(yi=fu.exec(v))&&yi[1]||"",di&&yi&&yi[2]&&it("Unsupported: "+yi[2]),ft){for(oi=h;oi&&!(nr=l(oi));)oi=oi.nextSibling;(lt=nr?nr._tkns:r._dfr)&&(gi=ar||"",(p||!ar)&&(gi+="#"+cu),et=lt.indexOf(gi),et+1&&(et+=gi.length,or=pt=lt.slice(0,et),lt=lt.slice(et),nr?oi.setAttribute(s,lt):r._dfr=lt))}if(pi=i,v=(""+v).replace(hu,yu),!f.noValidate&&gt.length&&ti("Mismatched '<"+ut+"...>' in:\n"+v),d)return;for(ur.appendChild(fr),si=o[si]||o.div,uu=si[0],wi.innerHTML=si[1]+v+si[2];uu--;)wi=wi.lastChild;for(ur.removeChild(fr),nu=e.createDocumentFragment();eu=wi.firstChild;)nu.appendChild(eu);r.insertBefore(nu,h)}return kt?setTimeout(ru,0):ru(),kt&&kt.promise()}function st(n,t,r,f,e,o){var w,v,b,l,k,d,y,p,a,s,tt;if(f=r.data===i?f||{}:r.data,e)s=c[e],s=s.linkCtx?s.linkCtx.tag:s,a=s.linkCtx||{data:f,elem:s._elCnt?s.parentElem:t,view:r,ctx:r.ctx,attr:h,fn:s._.bnd,tag:s,_bndId:e},vr(a,a.fn);else if(n&&t)for(w=r.tmpl,n=ku(n,ot(t)),g.lastIndex=0;v=g.exec(n);)tt=g.lastIndex,b=e?h:v[1],y=v[3],k=v[10],l=i,a={data:f,elem:s&&s._elCnt?s.parentElem:t,view:r,ctx:o||r.ctx,attr:b,_initVal:!v[2]},v[6]&&(!b&&(l=/:([\w$]*)$/.exec(k))&&(l=l[1],l!==i&&(d=-l.length-1,y=y.slice(0,d-1)+nt,k=k.slice(0,d))),l===null&&(l=i),a.convert=v[5]||""),a.expr=b+y,p=w.links[y],p||(w.links[y]=p=u.tmplFn(wi+y+bi,w,!0,l),u.parse(k,p.paths=[],w)),a.fn=p,b||l===i||(a.convertBack=l),vr(a,p),g.lastIndex=tt}function vr(n,t){function i(i,r){yu.call(n,i,r,t)}i.noArray=!0;n._ctxCb=du(n.view);n._hdlr=i;i(!0)}function ht(n,t){var i;return n?(i=n.indexOf(t),i+1?n.slice(0,i)+n.slice(i+t.length):n):""}function hi(n){return n&&(""+n===n?n:n.tagName==="SCRIPT"?n.type.slice(3):n.nodeType===1&&n.getAttribute(s)||"")}function l(n,t,i){function e(n,t,i,r,e,o){u.push({elCnt:f,id:r,ch:e,open:t,close:i,path:o,token:n})}var f,r,u=[];if(r=t?n:hi(n))return u.elCnt=!n.type,f=r.charAt(0)==="@"||!n.type,u._tkns=r,r.replace(i||vu,e),u}function yr(n,t){n&&(n.type==="jsv"?n.parentNode.removeChild(n):t&&n.getAttribute(a)===""&&n.removeAttribute(a))}function pr(n,t){for(var i=n;t&&i&&i.nodeType!==1;)i=i.previousSibling;return i&&(i.nodeType!==1?(i=e.createElement("SCRIPT"),i.type="jsv",n.parentNode.insertBefore(i,n)):hi(i)||i.getAttribute(a)||i.setAttribute(a,"")),i}function ku(n,i){return n=t.trim(n).replace(eu,"\\$&"),n.slice(-1)!==nt?n=yt+":"+n+(i?":":"")+nt:n}function ci(n,r){n!==!!n&&(r=n,n=i);var f,u=t(this.nodes());return u[0]&&(f=r?u.filter(r):u,u=n&&r?f.add(u.find(r)):f),u}function li(n,t,i){var r,u=this,f=u._elCnt,o=!t&&f,e=[];for(t=t||u._prv,i=i||u._nxt,r=o?t===u._nxt?u.parentElem.lastSibling:t:u._.inline===!1?t||u.linkCtx.elem.firstChild:t&&t.nextSibling;r&&(!i||r!==i);)(n||f||r.tagName!=="SCRIPT")&&e.push(r),r=r.nextSibling;return e}function ai(n,t){n!==!!n&&(t=n,n=i);var r=this,o=r.link?r:r.tagCtx.view,u=r._prv,f=r._elCnt,e=[];return u&&o.link(i,r.parentElem,f?u.previousSibling:u,r._nxt,i,{get:{tags:e,deep:n,name:t,id:f&&r._tgId}}),e}function wr(){var n=this.tagCtx.view;return this._.bnd.call(n.tmpl,n.data,n,r)}function ct(n,t){var f,r,s,e,o,a,v,l,y=t.view,h=n.linkCtx=n.linkCtx||{tag:n,data:y.data,view:y,ctx:y.ctx};if(n.onAfterLink)n.onAfterLink(t,h);if(f=n.targetTag?n.targetTag.linkedElem:n.linkedElem,f&&(r=f[0])&&((s=n._.radio)&&(f=f.children("input[type=radio]")),s||!n._.chging)){if(e=u.cvt(n,n.convert)[0],s||r!==h.elem){for(v=f.length;v--;){if(r=f[v],l=r._jsvLnkdEl,n._.inline&&(!l||l!==n&&l.targetTag!==n))for(r._jsvLnkdEl=n,o=h.elem?h.elem._jsvBnd:n._prv._jsvBnd,r._jsvBnd=o+"+",o=o.slice(1).split("&"),a=o.length;a--;)br(c[o[a]],n.convertBack);s&&(r[p]=e===r.value)}h._val=e}s||r.value===i||e===i||(r.type===kt?r[p]=e&&e!=="false":f.val(e))}}function br(n,t){var e,f,s,i,o,r=n.linkCtx,h=r.data,u=r.fn.paths;if(n){for((e=u._jsvto)&&(u=e),f=u.length;f&&""+(i=u[--f])!==i;);i&&(!r.tag||r.tag.tagCtx.args.length)?(i=i.split("^").join("."),n.to=i.charAt(0)==="."?[[o=u[f-1],i.slice(1)],t]:[r._ctxCb(s=f?u[0].split("^").join("."):i)||[h,s],t],e&&o&&(n.to[0][0]=r._ctxCb(o,h))):n.to=[[],t]}}function kr(n){var u,f,t=this,e=t.linkCtx,o=t.tagCtx.view;return t.disposed&&it("Removed tag"),n===i&&(n=r._tag(t,o,o.tmpl,t.currentCtxs?t.currentCtxs():t.tagCtxs,!0)),n+""===n&&(f=t._.inline?h:e.attr||ot(t.parentElem,!0),u=hr(n,e,f,t)),ct(t,t.tagCtx),u||t}function vi(n){for(var u,t,i,f=[],e=n.length,r=e;r--;)f.push(n[r]);for(r=e;r--;)if(t=f[r],t.parentNode){if(i=t._jsvBnd)for(i=i.slice(1).split("&"),t._jsvBnd="",u=i.length;u--;)lt(i[u],t._jsvLnkdEl,t);gr(hi(t)+(t._dfr||""))}}function lt(n,i,r){var h,l,f,o,s,a,v,y,e=c[n];if(i)r===i.linkedElem[0]&&(delete r._jsvLnkdEl,delete i.linkedElem);else if(e){for(h in e.bnd)o=e.bnd[h],s=".obs"+e.cbId,t.isArray(o)?t([o]).off(pt+s).off(gi+s):t(o).off(gi+s),delete e.bnd[h];if(l=e.linkCtx){if(f=l.tag){if(a=f.tagCtxs)for(v=a.length;v--;)(y=a[v].map)&&y.unmap();f.onDispose&&f.onDispose();f._elCnt||(f._prv&&f._prv.parentNode.removeChild(f._prv),f._nxt&&f._nxt.parentNode.removeChild(f._nxt));f.disposed=!0}delete l.view._.bnds[n]}delete c[n];delete u._cbBnds[e.cbId]}}function yi(n,r){return n===i?(w&&(t(w).off(nr,et),w=i),n=!0,v.removeViews(),vi(e.body.getElementsByTagName("*"))):r&&(r=r.jquery?r:t(r),n===!0&&r.each(function(){for(var n;(n=b(this,!0))&&n.parent;)n.parent.removeViews(n._.key,i,!0);vi(this.getElementsByTagName("*"))})),r}function dr(n,t){return yi(this,n,t)}function du(n){return n=n||t.view(),function(t,i){var f,u,e=[i];if(n&&t){if(t._jsvOb)return t._jsvOb.call(n.tmpl,i,n,r);if(t.charAt(0)==="~")return t.slice(0,4)==="~tag"&&(u=n.ctx,t.charAt(4)==="."&&(f=t.slice(5).split("."),u=u.tag),f)?u?[u,f.join("."),i]:[]:(t=t.slice(1).split("."),(i=n.hlp(t.shift()))&&(t.length&&e.unshift(t.join(".")),e.unshift(i)),i?e:[]);if(t.charAt(0)==="#")return t==="#data"?[]:[n,t.replace(su,""),i]}}}function gu(n){return n.type===kt?n[p]:n.value}function pi(n,t,i,r,u,f){var v,h,p,o,b,a,e,w=0,k=n===t;if(n){for(p=l(n)||[],v=0,h=p.length;v<h;v++){if(o=p[v],a=o.id,a===r&&o.ch===u)if(f)h=0;else break;k||(b=o.ch==="_"?y[a]:c[a].linkCtx.tag,o.open?b._prv=t:o.close&&(b._nxt=t));w+=a.length+2}w&&n.setAttribute(s,n.getAttribute(s).slice(w));e=t?t.getAttribute(s):i._dfr;(h=e.indexOf("/"+r+u)+1)&&(e=p._tkns.slice(0,w)+e.slice(h+(f?-1:r.length+1)));e&&(t?t.setAttribute(s,e):i._dfr=e)}else i._dfr=ht(i._dfr,"#"+r+u),f||t||(i._dfr=ht(i._dfr,"/"+r+u))}function gr(n){var r,f,t,u;if(u=l(n,1,cu))for(r=0,f=u.length;r<f;r++)t=u[r],t.ch==="_"?(t=y[t.id])&&t.data!==i&&t.parent.removeViews(t._.key,i,!0):lt(t.id)}function nf(n,i,r,u){switch(u.change){case"set":for(var f=i.length;f--;)if(i[f].key===u.path)break;f===-1?u.path&&t.observable(i).insert({key:u.path,prop:u.value}):u.value===null?(delete n[u.path],t.observable(i).remove(f)):t.observable(i[f]).setProperty("prop",u.value)}}function tf(n,i,r,u){var f;switch(u.change){case"set":u.path==="prop"?t.observable(n).setProperty(r.target.key,u.value):(t.observable(n).setProperty(u.oldValue,null),delete n[u.oldValue],t.observable(n).setProperty(u.value,r.target.prop));break;case"remove":f=u.items[0];t.observable(n).setProperty(f.key,null);delete n[f.key];break;case"insert":f=u.items[0];f.key&&t.observable(n).setProperty(f.key,f.prop)}}function rf(n,t,i){return i.indexOf(".")<0&&t[n]}var at="JsViews requires ",vt,w,b,g,wi,yt,nt,bi,ki,di,a,tt,o,e=n.document,r=t.views,u=r.sub,f=r.settings,k=u.extend,v=u.View(i,"top"),rt=u.isFn,nu=r.templates,tu=r.converters,d=t.observable,ut=d.observe,s="data-jsv",gi=u.propChng=u.propChng||"propertyChange",pt=u.arrChng=u.arrChng||"arrayChange",uf=u._cbBnds=u._cbBnds||{},nr="change.jsv",wt="onBeforeChange",bt="onAfterChange",iu="onAfterCreate",p="checked",kt="checkbox",ft="radio",tr='"><\/script>',ir='<script type="jsv',dt="script,["+s+"]",h="html",gt={value:"val",input:"val",html:h,text:"text"},rr={from:"value",to:"value"},ni=0,ru=t.cleanData,uu=f.delimiters,it=u.err,ti=u.syntaxErr,fu=/<(?!script)(\w+)(?:[^>]*(on\w+)\s*=)?[^>]*>/,eu=/['"\\]/g,ur=e.createDocumentFragment(),ii=e.querySelector,ri={ol:1,ul:1,table:1,tbody:1,thead:1,tfoot:1,tr:1,colgroup:1,dl:1,select:1,optgroup:1,svg:1,svg_ns:1},ou={tr:"table"},ui={br:1,img:1,input:1,hr:1,area:1,base:1,col:1,link:1,meta:1,command:1,embed:1,keygen:1,param:1,source:1,track:1,wbr:1},fr={},y={0:v},c={},er=1,su=/^#(view\.?)?/,hu=/(^|(\/>)|<\/(\w+)>|)(\s*)([#\/]\d+[_^])`(\s*)(<\w+(?=[\s\/>]))?|\s*(?:(<\w+(?=[\s\/>]))|<\/(\w+)>(\s*)|(\/>)\s*|(>))/g,or=/(#)()(\d+)(_)/g,cu=/(#)()(\d+)([_^])/g,lu=/(?:(#)|(\/))(\d+)(_)/g,au=/(#)()(\d+)(\^)/g,vu=/(?:(#)|(\/))(\d+)([_^])([-+@\d]+)?/g;if(!t)throw at+"jQuery";if(!t.views)throw at+"JsRender";if(!t.observable)throw at+"jquery.observable";t.link||(u.onStoreItem=function(n,i,r){r&&n===nu&&(r.link=ar,r.unlink=dr,i&&(t.link[i]=function(){return ar.apply(r,arguments)},t.unlink[i]=function(){return dr.apply(r,arguments)}))},(f.delimiters=function(){var n=uu.apply(r,arguments);return wi=n[0],yt=n[1],nt=n[2],bi=n[3],ki=n[4],g=new RegExp("(?:^|\\s*)([\\w-]*)(\\"+ki+")?(\\"+yt+u.rTag+"\\"+nt+")","g"),this})(),u.viewInfos=l,vt={addViews:function(n,t,i){var u,o,r=this,f=t.length,e=r.views;if(!r._.useKey&&f&&(i=r.tmpl)&&(o=e.length+f,lr(r,n,i,e,t,r.ctx)!==!1))for(u=n+f;u<o;u++)d(e[u]).setProperty("index",u);return r},removeViews:function(n,r,u){function o(n){var s,h,c,e,o,l,r=f[n];if(r&&r.link){if(s=r._.id,u||(l=r.nodes()),r.removeViews(i,i,!0),r.data=i,e=r._prv,o=r._nxt,c=r.parentElem,u||(r._elCnt&&pi(e,o,c,s,"_"),t(l).remove()),!r._elCnt)try{e.parentNode.removeChild(e);o.parentNode.removeChild(o)}catch(a){}fi(r);for(h in r._.bnds)lt(h);delete y[s]}}var e,l,s,h=this,c=!h._.useKey,f=h.views;if(c&&(s=f.length),n===i)if(c){for(e=s;e--;)o(e);h.views=[]}else{for(l in f)o(l);h.views={}}else if(r===i&&(c?r=1:(o(n),delete f[n])),c&&r){for(e=n+r;e-->n;)o(e);if(f.splice(n,r),s=f.length)while(n<s)d(f[n]).setProperty("index",n++)}return this},refresh:function(n){var t=this,i=t.parent;return i&&(lr(t,t.index,t.tmpl,i.views,t.data,n,!0),fi(t)),t},nodes:li,contents:ci,childTags:ai,link:bu},tu.merge=function(n){var t,i=this.linkCtx._val||"",r=this.tagCtx.props.toggle;return r&&(t=r.replace(/[\\^$.|?*+()[{]/g,"\\$&"),t="(\\s(?="+t+"$)|(\\s)|^)("+t+"(\\s|$))",i=i.replace(new RegExp(t),"$2"),n=i+(n?(i&&" ")+r:"")),n},r.tags("on",{attr:"none",onAfterLink:function(n,r){var o=this,s=t(r.elem),f=n.args,u=n.props.data,e=f.pop(),h=f[1]||null,c=n.props.context;if(u=u!==i?u:null,e&&e.call)s.on(f[0]||"click",h,u,function(n){e.call(c||o.leaf,n,{change:n.type,view:r.view,linkCtx:r})})},onAfterBind:function(n){this.leaf=n.leaf},flow:!0}),k(r.tags["for"],{onArrayChange:function(n,t){var i,r=this,u=t.change;if(r.tagCtxs[1]&&(u==="insert"&&n.target.length===t.items.length||u==="remove"&&!n.target.length||u==="refresh"&&!t.oldItems.length!=!n.target.length))r.refresh();else for(i in r._.arrVws)i=r._.arrVws[i],i.data===n.target&&i._.onArrayChange.apply(i,arguments);n.done=!0},onAfterLink:function(){for(var u,o,i,f,e=this,r=e._ars||{},s=e.tagCtxs,c=s.length,h=e.selected||0,n=0;n<=h;n++)u=s[n],f=u.map?u.map.tgt:u.args.length?u.args[0]:u.view.data,(i=r[n])&&f!==i[0]&&(ut(i[0],i[1],!0),delete r[n]),!r[n]&&t.isArray(f)&&(ut(f,o=function(n,t){e.onArrayChange(n,t)}),r[n]=[f,o]);for(n=h+1;n<c;n++)(i=r[n])&&(ut(i[0],i[1],!0),delete r[n]);e._ars=r},onDispose:function(){var n,t=this;for(n in t._ars)ut(t._ars[n][0],t._ars[n][1],!0)}}),r.tags({props:t.extend({},r.tags["for"],u.DataMap(r.tags.props.getTgt,nf,tf,i,rf))}),k(t,{view:r.view=b=function(n,r,u){r!==!!r&&(u=r,r=i);var f,o,h,c,w,s,b,a,p=0,k=e.body;if(n&&n!==k&&v._.useKey>1&&(n=""+n===n?t(n)[0]:n.jquery?n[0]:n,n))if(r){for(a=ii?n.querySelectorAll(dt):t(dt,n).get(),s=a.length,h=0;h<s;h++)for(b=a[h],o=l(b,i,or),c=0,w=o.length;c<w;c++)if(f=o[c],(f=y[f.id])&&(f=f&&u?f.get(!0,u):f,f))return f}else while(n){if(o=l(n,i,lu))for(s=o.length;s--;)if(f=o[s],f.open){if(p<1)return f=y[f.id],f&&u?f.get(u):f||v;p--}else p++;n=n.previousSibling||n.parentNode}return r?i:v},link:r.link=si,unlink:r.unlink=yi,cleanData:function(n){n.length&&ni&&vi(n);ru.apply(t,arguments)}}),r.utility={validate:function(n){try{v.link(i,e.createElement("div"),i,i,n,i,i,1)}catch(t){return t.message}}},k(t.fn,{link:function(n,t,i,r,u,f,e){return si(n,this,t,i,r,u,f,e)},unlink:function(n){return yi(n,this)},view:function(n){return b(this[0],n)}}),t.each([h,"replaceWith","empty","remove"],function(n,i){var r,u=t.fn[i];t.fn[i]=function(){ni=1;try{r=u.apply(this,arguments)}finally{ni=0}return r}}),k(v,{tmpl:{links:{},tags:{}}}),k(v,vt),v._.onRender=ei,f({wrapMap:o={option:[1,"<select multiple='multiple'>","<\/select>"],legend:[1,"<fieldset>","<\/fieldset>"],area:[1,"<map>","<\/map>"],param:[1,"<object>","<\/object>"],thead:[1,"<table>","<\/table>"],tr:[2,"<table><tbody>","<\/tbody><\/table>"],td:[3,"<table><tbody><tr>","<\/tr><\/tbody><\/table>"],col:[2,"<table><tbody><\/tbody><colgroup>","<\/colgroup><\/table>"],svg_ns:[1,"<svg>","<\/svg>"],div:jQuery.support.htmlSerialize?[0,"",""]:[1,"X<div>","<\/div>"]},linkAttr:a="data-link",merge:{input:{from:gu,to:"value"},textarea:rr,select:rr,optgroup:{to:"label"}},jsrDbgMode:f.debugMode,debugMode:function(t){f.jsrDbgMode(t);t?n._jsv={views:y,bindings:c}:delete n._jsv},jsv:function(){f.debugMode(f._dbgMode);a=f.linkAttr;tt=dt+",["+a+"]";di=f.noDomLevel0;o.optgroup=o.option;o.tbody=o.tfoot=o.colgroup=o.caption=o.thead;o.th=o.td}}))}(this,this.jQuery);
/*
//# sourceMappingURL=jsviews.min.js.map
*/